webpackJsonp([19],{Q4Wu:function(t,a){},"g8e/":function(t,a){},yKLP:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("P9l9"),r=e("XLwt"),s=e.n(r),n={props:{height:{type:[Number,String],default:450},width:{type:[Number,String],default:300},id:[String],echartsData:[Object]},mounted:function(){this.drawCharts()},data:function(){return{}},methods:{drawCharts:function(){var t=null;t=window.ActiveXObject||"ActiveXObject"in window?s.a.init(document.getElementById(this.id)):s.a.init(document.getElementById(this.id),null,{renderer:"svg"});for(var a=[],e=[],i=0,r=0;r<this.echartsData.series.length;r++){a.push(this.echartsData.series[r].title);var n={};n.name=this.echartsData.series[r].title,n.type="line",n.data=this.echartsData.series[r].data,n.smooth=!1,e.push(n);for(var l=0;l<this.echartsData.series[r].data.length;l++)this.echartsData.series[r].data[l]>i&&(i=this.echartsData.series[r].data[l])}i=parseInt(2*i),t.setOption({title:{text:this.echartsData.title,top:10,left:60,textStyle:{color:"#333333",fontSize:16,fontWeight:"normal"}},color:["#33ADEE","#F6B359","#8FCA82","#A1539C"],tooltip:{trigger:"axis"},legend:{bottom:0,data:a,textStyle:{fontSize:14}},yAxis:{type:"value",max:i},xAxis:{type:"category",boundaryGap:!1,data:this.echartsData.xAxis},series:e})}}},l={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{style:{width:this.width+"px",height:this.height+"px"},attrs:{id:this.id}})},staticRenderFns:[]};var o=e("VU/8")(n,l,!1,function(t){e("g8e/")},"data-v-5379c623",null).exports,h={props:{height:{type:[Number,String],default:450},width:{type:[Number,String],default:300},id:[String],echartsData:[Object]},mounted:function(){this.drawCharts()},data:function(){return{}},methods:{drawCharts:function(){var t=null;t=window.ActiveXObject||"ActiveXObject"in window?s.a.init(document.getElementById(this.id)):s.a.init(document.getElementById(this.id),null,{renderer:"svg"});for(var a=[],e=0;e<this.echartsData.data.length;e++)a.push(this.echartsData.data[e].name);t.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"horizontal",bottom:"0",data:a,textStyle:{fontSize:14}},color:["#33ADEE","#F6B359","#8FCA82","#A1539C"],series:[{type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,data:this.echartsData.data}]})}}},c={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{style:{width:this.width+"px",height:this.height+"px"},attrs:{id:this.id}})},staticRenderFns:[]},d={components:{warningLineChart:o,warningPieChart:e("VU/8")(h,c,!1,null,null,null).exports},mounted:function(){this.$refs.historyTable.doLayout(),this.getTableData(),this.getCurrentDefaultDate(),this.getInit()},data:function(){return{echarSearch:[],pagination:{page:1,total:30,size:10},warningLeft:{title:"",xAxis:[],series:[]},warnRight:{title:"",name:"告警数据",data:[]},tableParam:{messageType:"",informType:""},tableParamDate:[],warningData:[]}},methods:{getCurrentDefaultDate:function(){var t=(new Date).toLocaleDateString().split("/").join("-"),a=t.split("-"),e=new Date(Number(a[0]),Number(a[1])-1,Number(a[2])),i=e.setDate(e.getDate()-6),r=new Date(i).Format("yyyy-MM-dd");this.$set(this.echarSearch,0,r),this.$set(this.echarSearch,1,t)},tableSearch:function(){this.pagination.page=1,this.getTableData()},getTableData:function(){var t=this,a={};this.tableParamDate&&this.tableParamDate.length>0?(a.startDate=this.tableParamDate[0],a.endDate=this.tableParamDate[1]):(a.startDate=null,a.endDate=null),a.alarmClass=this.tableParam.messageType?this.tableParam.messageType:null,a.informType=this.tableParam.informType?this.tableParam.informType:null,this.$post(i.a.alarm.alarmDataList,a,function(a){0===a.code?(t.warningData=a.page.list,t.pagination.total=Number(a.page.totalCount)):(t.warningData=[],t.$message.error(a.msg))})},pineDateQuery:function(){this.getInit()},lineDateQuery:function(){this.getInit()},handleCurrentChange:function(t){this.$data.pagination.page=t},getInit:function(){var t=this,a={};t.echarSearch&&t.echarSearch.length>0?(a.startDate=t.echarSearch[0],a.endDate=t.echarSearch[1]):(a.startDate=null,a.endDate=null),t.$post(i.a.alarm.alarmDataChart,a,function(a){0===a.code?(console.log("dal"),console.log(a),t.warningLeft.series=[],t.warnRight.data=[],t.warningLeft.xAxis=a.timeList,console.log("2",t.warningLeft,t.warnRight),t.warningLeft.series.push({title:"Active MQ",data:a.activeList}),t.warningLeft.series.push({title:"Rabbit MQ",data:a.rabbitList}),t.warningLeft.series.push({title:"持续集成",data:a.jenkinsList}),t.warningLeft.series.push({title:"Memcached",data:a.memcacheList}),t.warningLeft.series.push({title:"Codis",data:a.codisList}),t.warningLeft.series.push({title:"Twemproxy",data:a.twemproxyList}),t.warnRight.data.push({name:"Active MQ",value:a.total.activemq}),t.warnRight.data.push({name:"Rabbit MQ",value:a.total.rabbitmq}),t.warnRight.data.push({name:"持续集成",value:a.total.jenkins}),t.warnRight.data.push({name:"Memcached",value:a.total.memcached}),t.warnRight.data.push({name:"Codis",value:a.total.codis}),t.warnRight.data.push({name:"Twemproxy",value:a.total.twemproxy}),t.$refs.warnigLineChart.drawCharts(),t.$refs.warningPieCharts.drawCharts(),console.log("warnig",t.warningLeft)):(t.warningLeft.series=[],t.warnRight.data=[],t.$refs.warnigLineChart.drawCharts(),t.$refs.warningPieCharts.drawCharts(),t.$message.warning(a.msg))})}}},p={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"history-page"},[e("div",{staticClass:"history-charts"},[e("div",{staticClass:"history-head"},[e("span",[t._v("告警统计")]),t._v(" "),e("el-date-picker",{staticClass:"todo-date",attrs:{type:"daterange","range-separator":"至","start-placeholder":"构建时间起","end-placeholder":"构建时间止","value-format":"yyyy-MM-dd","unlink-panels":""},model:{value:t.echarSearch,callback:function(a){t.echarSearch=a},expression:"echarSearch"}}),t._v(" "),e("span",{staticClass:"iconfont i-search",attrs:{title:"搜索"},on:{click:t.lineDateQuery}},[t._v("")])],1),t._v(" "),e("div",{staticClass:"charts-area"},[e("div",{staticClass:"line-chart"},[e("warning-line-chart",{ref:"warnigLineChart",attrs:{id:"history-left",echartsData:t.warningLeft,height:"310",width:"100%"}})],1),t._v(" "),e("div",{staticClass:"pie-chart"},[e("warning-pie-chart",{ref:"warningPieCharts",attrs:{id:"history-right",echartsData:t.warnRight,height:"310",width:"100%"}})],1)])]),t._v(" "),e("div",{staticClass:"history-table"},[e("div",{staticClass:"search-area"},[e("div",{staticClass:"search-item space-item"},[e("el-select",{staticClass:"search-select search-right",attrs:{placeholder:"信息类型",clearable:""},model:{value:t.tableParam.messageType,callback:function(a){t.$set(t.tableParam,"messageType",a)},expression:"tableParam.messageType"}},[e("el-option",{attrs:{value:"rabbitmq",label:"rabbitmq"}}),t._v(" "),e("el-option",{attrs:{value:"activemq",label:"activemq"}}),t._v(" "),e("el-option",{attrs:{value:"twemproxy",label:"twemproxy"}}),t._v(" "),e("el-option",{attrs:{value:"memcached",label:"memcached"}}),t._v(" "),e("el-option",{attrs:{value:"codis",label:"codis"}}),t._v(" "),e("el-option",{attrs:{value:"jenkins",label:"jenkins"}})],1),t._v(" "),e("el-select",{staticClass:"search-select search-right",attrs:{placeholder:"通知类型",clearable:""},model:{value:t.tableParam.informType,callback:function(a){t.$set(t.tableParam,"informType",a)},expression:"tableParam.informType"}},[e("el-option",{attrs:{value:"邮件",label:"邮件"}}),t._v(" "),e("el-option",{attrs:{value:"短信",label:"短信"}})],1),t._v(" "),e("el-date-picker",{staticClass:"todo-date",attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd","unlink-panels":""},model:{value:t.tableParamDate,callback:function(a){t.tableParamDate=a},expression:"tableParamDate"}}),t._v(" "),e("span",{staticClass:"iconfont i-search",attrs:{title:"搜索"},on:{click:t.tableSearch}},[t._v("")])],1)]),t._v(" "),e("el-table",{ref:"historyTable",staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.warningData,border:"","tooltip-effect":"light"}},[e("el-table-column",{attrs:{prop:"alarmClass",label:"消息类型","min-width":"120"}}),t._v(" "),e("el-table-column",{attrs:{prop:"informType",label:"通知类型","min-width":"120"}}),t._v(" "),e("el-table-column",{attrs:{prop:"sendContent",label:"消息内容","min-width":"180","show-overflow-tooltip":""}}),t._v(" "),e("el-table-column",{attrs:{prop:"acceptRoleName",label:"接收人","min-width":"140"}}),t._v(" "),e("el-table-column",{attrs:{prop:"alarmTime",label:"发送时间","min-width":"120"}})],1),t._v(" "),e("div",{staticClass:"pagination"},[e("div",{staticClass:"pagination-left"},[e("el-pagination",{attrs:{"current-page":t.pagination.page,"page-size":t.pagination.size,layout:"total, prev, pager, next, jumper",total:t.pagination.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),e("div",{staticClass:"pagination-right"},[t._v("\n        当前显示"+t._s((t.pagination.page-1)*t.pagination.size+1)+"-"+t._s((t.pagination.page-1)*t.pagination.size+t.warningData.length)+"条记录 "),e("span",[t._v("共"+t._s(t.pagination.total)+"条记录")])])])],1)])},staticRenderFns:[]};var g=e("VU/8")(d,p,!1,function(t){e("Q4Wu")},"data-v-781ec602",null);a.default=g.exports}});