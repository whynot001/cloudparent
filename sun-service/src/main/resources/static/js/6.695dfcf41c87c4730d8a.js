webpackJsonp([6],{"+Ele":function(t,e){},"31g2":function(t,e){},"7blE":function(t,e){},FfhQ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("P9l9"),i={data:function(){return{tag:"",username:"",password:""}},methods:{close:function(){this.$emit("close")},addUser:function(){var t=this;this.$post(a.a.rabbitMq.addUser,{area:"gz",username:this.username,password:this.password,tags:[this.tag]},function(e){e.success?setTimeout(function(){t.$emit("addUserClose")},2e3):t.$message.error("新增失败")})}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:!0,width:"470px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"dialong-text"},[t._v("添加用户")]),t._v(" "),s("span",{staticClass:"el-icon-close i-close",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"add-content"},[s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("用户名")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])]),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("密码")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])]),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("标签")]),t._v(" "),s("el-select",{staticClass:"send-select",attrs:{placeholder:"请选择",clearable:""},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}},[s("el-option",{attrs:{value:"administrator",label:"Admin"}}),t._v(" "),s("el-option",{attrs:{value:"monitoring",label:"Monitoring"}}),t._v(" "),s("el-option",{attrs:{value:"policymaker",label:"Policymaker"}}),t._v(" "),s("el-option",{attrs:{value:"management",label:"Management"}}),t._v(" "),s("el-option",{attrs:{value:"",label:"None"}})],1)],1)]),t._v(" "),s("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.close}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"save-btn",on:{click:t.addUser}},[t._v("确定")])])])},staticRenderFns:[]};var o=s("VU/8")(i,n,!1,function(t){s("WY4Z")},"data-v-b70bbc2a",null).exports,l={data:function(){return{tag:"",username:"",password:""}},methods:{close:function(){this.$emit("close")},addUser:function(){var t=this;this.$post(a.a.rabbitMq.addUser,{area:"gz",username:this.username,password:this.password,tags:[this.tag]},function(e){e.success?setTimeout(function(){t.$emit("addUserClose")},2e3):t.$message.error("新增失败")})}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:!0,width:"470px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"dialong-text"},[t._v("编辑用户")]),t._v(" "),s("span",{staticClass:"el-icon-close i-close",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"add-content"},[s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("用户名")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])]),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("密码")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])]),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("标签")]),t._v(" "),s("el-select",{staticClass:"send-select",attrs:{placeholder:"请选择",clearable:""},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}},[s("el-option",{attrs:{value:"administrator",label:"Admin"}}),t._v(" "),s("el-option",{attrs:{value:"monitoring",label:"Monitoring"}}),t._v(" "),s("el-option",{attrs:{value:"policymaker",label:"Policymaker"}}),t._v(" "),s("el-option",{attrs:{value:"management",label:"Management"}}),t._v(" "),s("el-option",{attrs:{value:"",label:"None"}})],1)],1)]),t._v(" "),s("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.close}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"save-btn",on:{click:t.addUser}},[t._v("确定")])])])},staticRenderFns:[]};var c=s("VU/8")(l,r,!1,function(t){s("iZO/")},"data-v-83d07fe6",null).exports,d={props:["vhosts","user"],data:function(){return{vhostList:[],vhost:null,configure:".*",write:".*",read:".*"}},mounted:function(){this.commonVhosts(),console.log("vhosts",this.vhosts),console.log("vhosts",this.user)},methods:{refreshPerssion:function(){this.$emit("refresh")},closePerssion:function(){this.$emit("close")},commonVhosts:function(){var t=this;this.$post(a.a.rabbitMq.commonVhosts,{area:a.a.defaultArea},function(e){e.success?(t.vhostList=e.data,t.vhost=t.vhostList[0].name):t.$message.error("获取虚拟机列表失败")})},addUserPerssion:function(){var t=this;console.log("vhostList",this.vhostList),this.$post(a.a.rabbitMq.addUserPerssion,{area:a.a.defaultArea,userPermissions:{user:this.user,vhost:this.vhost,read:this.read,write:this.write,configure:this.configure}},function(e){e.success?(t.$message.success("新增成功"),t.refreshPerssion()):t.$message.error("新增失败")})}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:!0,width:"470px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"dialong-text"},[t._v("添加权限")]),t._v(" "),s("span",{staticClass:"el-icon-close i-close",on:{click:t.closePerssion}})]),t._v(" "),s("div",{staticClass:"add-content"},[s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("虚拟主机")]),t._v(" "),s("el-select",{staticClass:"add-ipt",attrs:{placeholder:"请选择",clearable:""},model:{value:t.vhost,callback:function(e){t.vhost=e},expression:"vhost"}},t._l(t.vhostList,function(t){return s("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})}),1)],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("Configure regexp")]),t._v(" "),s("el-input",{staticClass:"add-ipt",attrs:{type:"text"},model:{value:t.configure,callback:function(e){t.configure=e},expression:"configure"}})],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("Write regexp")]),t._v(" "),s("el-input",{staticClass:"add-ipt",attrs:{type:"text"},model:{value:t.write,callback:function(e){t.write=e},expression:"write"}})],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("Read regexp")]),t._v(" "),s("el-input",{staticClass:"add-ipt",attrs:{type:"text"},model:{value:t.read,callback:function(e){t.read=e},expression:"read"}})],1)]),t._v(" "),s("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.closePerssion}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"save-btn",on:{click:t.addUserPerssion}},[t._v("确定")])])])},staticRenderFns:[]};var v={components:{addUser:o,addPerssion:s("VU/8")(d,u,!1,function(t){s("YIME")},"data-v-05aafa10",null).exports,editUser:c},mounted:function(){var t=this;this.$refs.userTable.doLayout(),this.getUserList(),this.$data.usersInterVal=setInterval(function(){t.getUserList()},3e4)},beforeDestroy:function(){console.log("清空"),clearInterval(this.$data.usersInterVal)},data:function(){return{editUserPerssionShow:!1,userName:"",singleUser:"",vhosts:[],userTable:[],showAddDialog:!1,showAddPerssion:!1,showDetail:!1,perssionTable:[],updateParam:"password",sign:"",password:"",password_confirm:"",showPerssionTable:!0,showEditDialog:!1,usersInterVal:null}},methods:{editUserPerssion:function(){this.editUserPerssionShow=!0},updateUserList:function(){this.showAddDialog=!1,this.getUserList()},getUserList:function(){var t=this;this.$post(a.a.rabbitMq.users,{area:a.a.defaultArea},function(e){if(e.success)if(t.$data.userName){var s=[];e.data.forEach(function(e){e.user.name.indexOf(t.$data.userName)>=0&&s.push(e)}),t.userTable=s}else t.userTable=e.data;else t.$data.message.error("获取用户列表失败")})},handleOpenAdd:function(){this.$data.showAddDialog=!0},handleDetail:function(t,e){var s=this;this.$data.password="",this.$data.password_confirm="",this.showAddPerssion=!1,this.$data.singleUser=t,e&&(this.$data.sign=e.join(",")),this.$post(a.a.rabbitMq.singleUser,{area:a.a.defaultArea,name:t},function(t){t.success?(s.perssionTable=t.permissions,s.vhosts=t.vhosts):s.$message.error("失败失败！")}),this.$data.showDetail=!0},handleBackUser:function(){this.$data.showPerssionTable=!1,this.$data.showDetail=!1},handleOpenPerssion:function(){this.$data.showAddPerssion=!0},deleteUserPerssion:function(t){var e=this;this.$confirm("确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$post(a.a.rabbitMq.deleteUserPerssion,{area:a.a.defaultArea,username:e.$data.singleUser,vhost:t,message:{}},function(t){t.success?(e.$message.success("清除权限成功"),e.handleDetail(e.$data.singleUser)):e.$message.error("清除权限失败")})})},updateUser:function(){var t=this;""==this.$data.password&&this.$message.error("请输出密码."),this.$data.password!=this.$data.password_confirm&&this.$message.error("密码不匹配."),this.$post(a.a.rabbitMq.addUser,{area:a.a.defaultArea,username:this.$data.singleUser,password:this.password,tags:[this.sign]},function(e){e.success?(t.editUserPerssionShow=!1,that.$message.success("更新成功！"),setTimeout(function(){t.handleDetail(t.$data.singleUser)},2e3)):t.$message.error("新增失败")})},deleteUser:function(t){var e=this;this.$confirm("确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$post(a.a.rabbitMq.deleteUser,{area:a.a.defaultArea,username:t.user.name},function(t){t.success?(e.$message.success("删除成功！"),e.updateUserList()):e.$message.error("删除失败！")})})},handleDeleteUser:function(t){console.log(t),this.$data.showEditDialog=!0}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-page"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showDetail,expression:"!showDetail"}]},[s("div",{staticClass:"connect-head"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.userName,expression:"userName"}],staticClass:"connect-ipt",attrs:{type:"text",placeholder:"用户名称"},domProps:{value:t.userName},on:{input:function(e){e.target.composing||(t.userName=e.target.value)}}}),t._v(" "),s("span",{staticClass:"iconfont i-search",on:{click:t.getUserList}},[t._v("")]),t._v(" "),s("div",{staticClass:"add-user"},[s("button",{staticClass:"add-btn",on:{click:t.handleOpenAdd}},[t._v("添加用户")])])]),t._v(" "),s("el-table",{ref:"userTable",staticStyle:{width:"100%"},attrs:{data:t.userTable,border:""}},[s("el-table-column",{attrs:{prop:"user.name",label:"用户名称","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"user-detail",on:{click:function(s){return t.handleDetail(e.row.user.name,e.row.user.tags)}}},[t._v(t._s(e.row.user.name))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"user.tags",label:"角色标签","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"permissions",label:"允许进入的vhost","min-width":"160"}}),t._v(" "),s("el-table-column",{attrs:{prop:"password_hash",label:"密码","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v("\n          "+t._s(""!==e.row.password_hash?"●":"○")+"\n        ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"column5",label:"操作","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("button",{staticClass:"edit-btn",on:{click:function(s){return t.editUserPerssion(e.row.vhost)}}},[t._v("编辑")]),t._v(" "),s("button",{staticClass:"delete-btn",on:{click:function(s){return t.deleteUser(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail,expression:"showDetail"}]},[s("div",{staticClass:"back-userlist"},[s("button",{staticClass:"add-btn",on:{click:t.handleBackUser}},[t._v("返回")])]),t._v(" "),s("div",{staticClass:"perssion-content"},[s("div",{staticClass:"perssion-head",on:{click:function(e){t.showPerssionTable=!t.showPerssionTable}}},[s("span",{staticClass:"perssion-text"},[t._v("权限")]),t._v(" "),s("span",{staticClass:"perssion-icon el-icon-arrow-right"})]),t._v(" "),s("div",{staticClass:"hidden-content"},[s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showPerssionTable,expression:"showPerssionTable"}],staticClass:"perssion-list"},[s("div",{staticClass:"perssion-add"},[s("button",{staticClass:"add-btn",on:{click:t.handleOpenPerssion}},[t._v("添加权限")])]),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.perssionTable,border:""}},[s("el-table-column",{attrs:{prop:"vhost",label:"虚拟主机","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"configure",label:"Configure regexp","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"write",label:"Write regexp","min-width":"120"}}),t._v(" "),s("el-table-column",{attrs:{prop:"read",label:"Read regexp","min-width":"120"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column5",label:"操作","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("button",{staticClass:"delete-btn",on:{click:function(s){return t.deleteUserPerssion(e.row.vhost)}}},[t._v("清除")])]}}])})],1)],1)])],1)]),t._v(" "),t.editUserPerssionShow?[s("el-dialog",{attrs:{visible:!0,width:"600px","close-on-press-escape":!1,"append-to-body":"","show-close":!1}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"perssion-text"},[t._v("更新此用户")]),t._v(" "),s("span",{staticClass:"i-close el-icon-close",on:{click:function(e){t.editUserPerssionShow=!1}}})]),t._v(" "),s("div",{staticClass:"update-content"},[s("div",{staticClass:"update-item"},[s("span",{staticClass:"update-title"},[t._v("请输入密码：")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"update-ipt",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"update-item"},[s("span",{staticClass:"update-title"},[t._v("再次确认密码：")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password_confirm,expression:"password_confirm"}],staticClass:"update-ipt",attrs:{type:"password"},domProps:{value:t.password_confirm},on:{input:function(e){e.target.composing||(t.password_confirm=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"update-item"},[s("span",{staticClass:"update-title"},[t._v("标签：")]),t._v(" "),s("el-select",{staticStyle:{width:"270px"},attrs:{placeholder:"请选择"},model:{value:t.sign,callback:function(e){t.sign=e},expression:"sign"}},[s("el-option",{attrs:{value:"administrator"}},[t._v("Admin")]),t._v(" "),s("el-option",{attrs:{value:"monitoring"}},[t._v("Monitoring")]),t._v(" "),s("el-option",{attrs:{value:"policymaker"}},[t._v("Policymaker")]),t._v(" "),s("el-option",{attrs:{value:"management"}},[t._v("Management")]),t._v(" "),s("el-option",{attrs:{value:"",label:"None"}})],1)],1)]),t._v(" "),s("div",{staticClass:"update-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:function(e){t.editUserPerssionShow=!1}}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"confirm-btn",on:{click:t.updateUser}},[t._v("确定")])])])]:t._e()],2),t._v(" "),t.showAddDialog?s("add-user",{on:{close:function(e){t.showAddDialog=!1},addUserClose:t.updateUserList}}):t._e(),t._v(" "),t.showAddPerssion?s("add-perssion",{attrs:{vhosts:t.vhosts,user:t.singleUser},on:{close:function(e){t.showAddPerssion=!1},refresh:function(e){return t.handleDetail(t.singleUser)}}}):t._e(),t._v(" "),t.showEditDialog?s("edit-user",{on:{close:function(e){t.showEditDialog=!1}}}):t._e()],1)},staticRenderFns:[]};var h=s("VU/8")(v,p,!1,function(t){s("RZ4/")},"data-v-7c52ee72",null).exports,m={data:function(){return{vhostname:""}},methods:{close:function(){this.$emit("close")},refresh:function(){this.$emit("refresh")},addVhost:function(){var t=this;this.$post(a.a.rabbitMq.addVhost,{area:a.a.defaultArea,name:this.$data.vhostname},function(e){e.success?setTimeout(function(){t.$message.success("新增成功"),t.refresh()},2e3):t.$message.error("新增失败")})}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:!0,width:"470px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"dialong-text"},[t._v("添加虚拟主机")]),t._v(" "),s("span",{staticClass:"el-icon-close i-close",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"add-content"},[s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("虚拟主机名称")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.vhostname,expression:"vhostname"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.vhostname},on:{input:function(e){e.target.composing||(t.vhostname=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])])]),t._v(" "),s("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.close}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"save-btn",on:{click:t.addVhost}},[t._v("确定")])])])},staticRenderFns:[]};var _=s("VU/8")(m,f,!1,function(t){s("+Ele")},"data-v-75825a44",null).exports,b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:!0,width:"470px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"dialong-text"},[t._v("编辑虚拟主机")]),t._v(" "),s("span",{staticClass:"el-icon-close i-close",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"add-content"},[s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("虚拟主机名称")]),t._v(" "),s("input",{staticClass:"add-ipt",attrs:{type:"text"}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])])]),t._v(" "),s("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.close}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"save-btn",on:{click:t.close}},[t._v("确定")])])])},staticRenderFns:[]};var g=s("VU/8")({data:function(){return{tag:""}},methods:{close:function(){this.$emit("close")}}},b,!1,function(t){s("bPDp")},"data-v-07433782",null).exports,y={props:["userList","vhost"],data:function(){return{user:this.userList[0].name,configure:".*",write:".*",read:".*"}},methods:{close:function(){this.$emit("close")},refresh:function(){this.$emit("refresh")},addVhostPerssion:function(){var t=this;this.$post(a.a.rabbitMq.updateVhostPermissions,{area:a.a.defaultArea,userPermissions:{user:this.user,vhost:this.vhost,read:this.read,write:this.write,configure:this.configure}},function(e){e.success?(t.$message.success("新增权限成功"),t.refresh()):t.$message.error("新增权限失败")})}}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:!0,width:"470px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"dialong-text"},[t._v("添加权限")]),t._v(" "),s("span",{staticClass:"el-icon-close i-close",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"add-content"},[s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("用户")]),t._v(" "),s("el-select",{staticClass:"add-ipt",attrs:{placeholder:"请选择",clearable:""},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}},t._l(t.userList,function(t){return s("el-option",{key:t,attrs:{label:t.name,value:t.name}})}),1)],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("Configure regexp")]),t._v(" "),s("el-input",{staticClass:"add-ipt",attrs:{type:"text"},model:{value:t.configure,callback:function(e){t.configure=e},expression:"configure"}})],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("Write regexp")]),t._v(" "),s("el-input",{staticClass:"add-ipt",attrs:{type:"text"},model:{value:t.write,callback:function(e){t.write=e},expression:"write"}})],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("Read regexp")]),t._v(" "),s("el-input",{staticClass:"add-ipt",attrs:{type:"text"},model:{value:t.read,callback:function(e){t.read=e},expression:"read"}})],1)]),t._v(" "),s("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.close}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"save-btn",on:{click:t.addVhostPerssion}},[t._v("确定")])])])},staticRenderFns:[]};var C={components:{addVirtualHost:_,addPerssion:s("VU/8")(y,w,!1,function(t){s("i1D0")},"data-v-38c9e893",null).exports,editVirtualHost:g},mounted:function(){var t=this;this.$refs.virtualTable.doLayout(),this.getVhostsList(),this.$data.vhostInterVal=setInterval(function(){t.getVhostsList()},3e4)},beforeDestroy:function(){clearInterval(this.$data.vhostInterVal)},data:function(){return{userList:[],theVhost:"",vhostsTable:[],vhostName:"",showAddDialog:!1,showAddPerssion:!1,showEditVirtualDialog:!1,showDetail:!1,perssionTable:[],updateParam:"password",sign:"",showPerssionTable:!0,vhostInterVal:null}},methods:{handleOpenAdd:function(){this.$data.showAddDialog=!0},handleDetail:function(t){var e=this;this.showAddPerssion=!1,console.log(name),this.$data.showDetail=!0,this.$data.theVhost=t,this.$post(a.a.rabbitMq.singleVhost,{area:a.a.defaultArea,name:t},function(t){t.success?(e.$data.perssionTable=t.permissions,e.$data.userList=t.users):e.$message.error("加载虚拟机详情失败")})},deleteVhostPerssion:function(t){var e=this;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$post(a.a.rabbitMq.deleteVhostPermission,{area:a.a.defaultArea,vhost:e.theVhost,username:t},function(t){t.success?(e.$message.success("删除成功"),e.handleDetail(e.theVhost)):e.$message.error("删除虚拟机权限失败")})})},handleBackUser:function(){this.$data.showPerssionTable=!1,this.$data.showDetail=!1,this.$data.showAddDialog=!1,this.getVhostsList()},handleOpenPerssion:function(){this.$data.showAddPerssion=!0},handleEditVirtual:function(t){console.log(t),this.$data.showEditVirtualDialog=!0},getVhostsList:function(){var t=this;this.$post(a.a.rabbitMq.vhosts,{area:a.a.defaultArea},function(e){if(e.success)if(t.$data.vhostName){var s=[];e.data.forEach(function(e){e.name.indexOf(t.$data.vhostName)>=0&&s.push(e)}),t.vhostsTable=s}else t.vhostsTable=e.data;else t.$message.error("加载虚拟机列表失败")})},deleteVhost:function(t){var e=this;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$post(a.a.rabbitMq.deleteVhost,{area:a.a.defaultArea,name:t},function(t){t.success?(e.$message.success("删除成功"),setTimeout(function(){e.getVhostsList()},2e3)):(loading.close(),e.$message.error("删除失败"))})})}}},x={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.showDetail?[s("div",{staticClass:"back-userlist"},[s("button",{staticClass:"add-btn",on:{click:t.handleBackUser}},[t._v("返回")])]),t._v(" "),s("div",{staticClass:"perssion-content"},[s("div",{staticClass:"perssion-head",on:{click:function(e){t.showPerssionTable=!t.showPerssionTable}}},[s("span",{staticClass:"perssion-text"},[t._v("权限")]),t._v(" "),s("span",{staticClass:"perssion-icon el-icon-arrow-right"})]),t._v(" "),s("div",{staticClass:"hidden-content"},[s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showPerssionTable,expression:"showPerssionTable"}],staticClass:"perssion-list"},[s("div",{staticClass:"perssion-add"},[s("button",{staticClass:"add-btn",on:{click:t.handleOpenPerssion}},[t._v("添加权限")])]),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.perssionTable,border:""}},[s("el-table-column",{attrs:{prop:"user",label:"用户","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"configure",label:"Configure regexp","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"write",label:"Write regexp","min-width":"120"}}),t._v(" "),s("el-table-column",{attrs:{prop:"read",label:"Read regexp","min-width":"120"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column5",label:"操作","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("button",{staticClass:"delete-btn",on:{click:function(s){return t.deleteVhostPerssion(e.row.user)}}},[t._v("清除")])]}}])})],1)],1)])],1)])]:[s("div",{staticClass:"connect-head"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.vhostName,expression:"vhostName"}],staticClass:"connect-ipt",attrs:{type:"text",placeholder:"虚拟主机名称"},domProps:{value:t.vhostName},on:{input:function(e){e.target.composing||(t.vhostName=e.target.value)}}}),t._v(" "),s("span",{staticClass:"iconfont i-search"},[t._v("")]),t._v(" "),s("div",{staticClass:"add-user"},[s("button",{staticClass:"add-btn add-long",on:{click:t.handleOpenAdd}},[t._v("添加虚拟主机")])])]),t._v(" "),s("el-table",{ref:"virtualTable",staticStyle:{width:"100%"},attrs:{data:t.vhostsTable,border:""}},[s("el-table-column",{attrs:{prop:"vhost.name",label:"虚拟主机名称","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"user-detail",on:{click:function(s){return t.handleDetail(e.row.vhost.name)}}},[t._v(t._s(e.row.vhost.name))])]}}],null,!1,559303349)}),t._v(" "),s("el-table-column",{attrs:{prop:"users",label:"用户","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"vhost.messages_ready",label:"Ready","min-width":"100"}}),t._v(" "),s("el-table-column",{attrs:{prop:"vhost.messages_unacknowledged",label:"Unacked","min-width":"100"}}),t._v(" "),s("el-table-column",{attrs:{prop:"vhost.messages",label:"总数","min-width":"100"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column0",label:"From client","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v("\n            "+t._s(null!==e.row.vhost.recv_oct_details?e.row.vhost.recv_oct_details.rate+" B/s":"")+"\n          ")])]}}],null,!1,3239430848)}),t._v(" "),s("el-table-column",{attrs:{prop:"column1",label:"To client","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v("\n            "+t._s(null!==e.row.vhost.send_oct_details?e.row.vhost.send_oct_details.rate+" B/s":"")+"\n          ")])]}}],null,!1,2713662400)}),t._v(" "),s("el-table-column",{attrs:{prop:"column2",label:"publish","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v("\n            "+t._s(null!==e.row.vhost.message_stats&&null!==e.row.vhost.message_stats.publish_details?e.row.vhost.message_stats.publish_details.rate+" /s":"")+"\n          ")])]}}],null,!1,372311957)}),t._v(" "),s("el-table-column",{attrs:{prop:"column3",label:"deliver/get","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v("\n            "+t._s(null!==e.row.vhost.message_stats&&null!==e.row.vhost.message_stats.deliver_get_details?e.row.vhost.message_stats.deliver_get_details.rate+" /s":"")+"\n          ")])]}}],null,!1,1350571157)}),t._v(" "),s("el-table-column",{attrs:{prop:"column6",label:"操作","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("button",{staticClass:"delete-btn",on:{click:function(s){return t.deleteVhost(e.row.vhost.name)}}},[t._v("删除")])]}}],null,!1,649925932)})],1)],t._v(" "),t.showAddDialog?s("add-virtual-host",{on:{close:function(e){t.showAddDialog=!1},refresh:t.handleBackUser}}):t._e(),t._v(" "),t.showAddPerssion?s("add-perssion",{attrs:{userList:t.userList,vhost:t.theVhost},on:{close:function(e){t.showAddPerssion=!1},refresh:function(e){return t.handleDetail(t.theVhost)}}}):t._e(),t._v(" "),t.showEditVirtualDialog?s("edit-virtual-host",{on:{close:function(e){t.showEditVirtualDialog=!1}}}):t._e()],2)},staticRenderFns:[]};var $=s("VU/8")(C,x,!1,function(t){s("tQ+g")},"data-v-9b0e55be",null).exports,k={data:function(){return{definitions:[{key:"",value:"",type:"String"}],policyName:"",pattern:"",priority:null,virtualHostList:[],virtualHost:"",applyTo:"all",defList:["ha-mode","ha-params","ha-sync-mode","federation-upstream-set","federation-upstream","message-ttl","expires","max-length","max-length-bytes","dead-letter-exchange","dead-letter-routing-key","alternate-exchange"]}},mounted:function(){this.commonVhosts()},methods:{close:function(){this.$emit("close")},refresh:function(){this.$emit("refresh")},changeDefinition:function(t,e){if(""===t.key&&""===t.value)this.$data.definitions.splice(e,1);else if((""!==t.key||""!==t.value)&&("ha-params"==t.key.trim()?t.type="Number":this.definitions.push({key:"",value:"",type:"String"}),this.$data.definitions[e+1]))return},changeDefinitionType:function(t,e){console.log(t),"ha-params"==t.key?t.type="Number":t.type="String"},commonVhosts:function(){var t=this;this.$post(a.a.rabbitMq.commonVhosts,{area:a.a.defaultArea},function(e){e.success?(t.virtualHostList=e.data,t.virtualHost=e.data[0].name):t.$message.error("获取虚拟机列表失败")})},updatePolicies:function(){var t=this;if(""!=this.policyName&&""!=this.pattern&&""!=this.definitions[0].key){var e=[],s=this;if(this.definitions.forEach(function(t){t.key&&-1==s.defList.indexOf(t.key.trim())&&e.push(t.key.trim())}),e.length>0)this.$message.warning("参数"+e.join(",")+"定义有误，请更正。");else{for(var i={},n=0;n<this.definitions.length;n++)if(""!==this.definitions[n].key||""!==this.definitions[n].value)if("Number"==this.definitions[n].type||"number"==this.definitions[n].type){var o=Number(this.definitions[n].value.trim());if(isNaN(o))return void this.$message.warning("定义中第"+(n+1)+"条"+this.definitions[n].value+"数据类型与选择的不符，请重新选择！");i[this.definitions[n].key.trim()]=Number(this.definitions[n].value.trim())}else i[this.definitions[n].key.trim()]=this.definitions[n].value.trim();this.$post(a.a.rabbitMq.updatePolicies,{area:a.a.defaultArea,policyInfo:{vhost:this.virtualHost,name:this.policyName,pattern:this.pattern,priority:parseInt(this.priority),definition:i,"apply-to":this.applyTo},message:{vhost:this.virtualHost,name:this.policyName,pattern:this.pattern,priority:parseInt(this.priority),definition:i,"apply-to":this.applyTo}},function(e){e.success?(t.$message.success("新增成功"),setTimeout(function(){t.refresh()},2e3)):t.$message.error("定义参数有误，新增失败")})}}else this.$message.warning("请填写必填项。")}}},P={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:!0,width:"680px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"dialong-text"},[t._v("添加policies")]),t._v(" "),s("span",{staticClass:"el-icon-close i-close",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"add-content"},[s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("虚拟主机")]),t._v(" "),s("el-select",{staticClass:"send-short",attrs:{placeholder:"虚拟机名称",clearable:""},model:{value:t.virtualHost,callback:function(e){t.virtualHost=e},expression:"virtualHost"}},t._l(t.virtualHostList,function(t){return s("el-option",{key:t.name,attrs:{value:t.name,label:t.name}})}),1)],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("名称")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.policyName,expression:"policyName"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.policyName},on:{input:function(e){e.target.composing||(t.policyName=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])]),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("模式")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.pattern,expression:"pattern"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.pattern},on:{input:function(e){e.target.composing||(t.pattern=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])]),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("应用范围")]),t._v(" "),s("el-select",{staticClass:"send-select",attrs:{placeholder:"请选择",clearable:""},model:{value:t.applyTo,callback:function(e){t.applyTo=e},expression:"applyTo"}},[s("el-option",{attrs:{value:"all",label:"Exchanges and queues"}}),t._v(" "),s("el-option",{attrs:{value:"exchanges",label:"Exchanges"}}),t._v(" "),s("el-option",{attrs:{value:"queues",label:"Queues"}})],1)],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("优先级")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.priority,expression:"priority"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.priority},on:{input:function(e){e.target.composing||(t.priority=e.target.value)}}})]),t._v(" "),t._l(t.definitions,function(e,a){return s("div",{key:a+"definitions",staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v(t._s(0==a?"定义":""))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.key,expression:"item.key"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:e.key},on:{input:[function(s){s.target.composing||t.$set(e,"key",s.target.value)},function(s){return t.changeDefinition(e,a)}]}}),t._v(" "),s("span",{staticClass:"add-equal"},[t._v("=")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:e.value},on:{input:[function(s){s.target.composing||t.$set(e,"value",s.target.value)},function(s){return t.changeDefinition(e,a)}]}}),t._v(" "),s("el-select",{staticClass:"send-shortselect",attrs:{placeholder:"请选择",clearable:""},on:{change:function(s){return t.changeDefinitionType(e,a)}},model:{value:e.type,callback:function(s){t.$set(e,"type",s)},expression:"item.type"}},[s("el-option",{attrs:{label:"String",value:"String"}}),t._v(" "),s("el-option",{attrs:{label:"Number",value:"Number"}})],1),t._v(" "),s("span",{staticClass:"add-require"},[t._v(t._s(0==a?"*":""))])],1)})],2),t._v(" "),s("div",{staticClass:"definationTable",staticStyle:{padding:"0px 27px 0px 77px"}},[s("div",{staticClass:"definationTip"},[t._v("定义提示:")]),t._v(" "),s("table",[s("tr",{staticStyle:{height:"20px"}},[s("td",{staticStyle:{width:"90px"}},[t._v("HA:")]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            其中之一all:(镜像到集群中的所有节点)、exactly:精确(镜像到一组节点)\n            或nodes:节点(镜像到一个显式节点列表)。如果您选择后两个中的一个，您还必须设置ha-params。\n          ")]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v("ha-mode |")])]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            如果ha-mode是all，则不填;如果ha-mode是exactly,则填一个数字;如果ha-mode是节点nodes，则填写一个字符串列表。\n          ")]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v("ha-params |")])]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            手动manual或自动的automatic。\n          ")]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v("ha-sync-mode")])])],1),t._v(" "),s("tr",{staticStyle:{height:"20px"}},[s("td",{staticStyle:{width:"90px"}},[t._v("Federation:")]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            一个字符串;只有在启用了联合插件的情况下。选择一组upstreams的名称以与联邦一起使用，或选择“all”以使用所有upstreams。与federation-upstream不相容。\n          ")]),t._v(" "),s("td",[t._v("federation-upstream-set |")])]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n           一个字符串;只有在启用了联合插件的情况下。选择用于联合的特定上游集。与federation-upstream-set不相容。\n          ")]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v("ha-sync-mode")])])],1),t._v(" "),s("tr",{staticStyle:{height:"34px"}},[s("td",{staticStyle:{width:"90px"}},[t._v("Queues:")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[t._v("message-ttl | expires | max-length |max-length-bytes|dead-letter-exchange |dead-letter-routing-key")])]),t._v(" "),s("tr",{staticStyle:{height:"20px"}},[s("td",{staticStyle:{width:"90px"}},[t._v("Exchanges:")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[t._v("alternate-exchange")])])])]),t._v(" "),s("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.close}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"save-btn",on:{click:t.updatePolicies}},[t._v("确定")])])])},staticRenderFns:[]};var T={props:["editPoliy"],data:function(){return{definitions:[],policyName:"",pattern:"",priority:null,virtualHostList:[],virtualHost:"",applyTo:"all",defList:["ha-mode","ha-params","ha-sync-mode","federation-upstream-set","federation-upstream","message-ttl","expires","max-length","max-length-bytes","dead-letter-exchange","dead-letter-routing-key","alternate-exchange"]}},mounted:function(){for(var t in this.commonVhosts(),console.log("ds",this.editPoliy),this.$data.policyName=this.editPoliy.name,this.$data.pattern=this.editPoliy.pattern,this.$data.priority=this.editPoliy.priority,this.$data.virtualHost=this.editPoliy.vhost,this.applyTo=this.editPoliy["apply-to"],this.editPoliy.definition)"ha-params"==t?this.$data.definitions.push({key:t,value:this.editPoliy.definition[t],type:"Number"}):this.$data.definitions.push({key:t,value:this.editPoliy.definition[t],type:"String"});this.$data.definitions.push({key:"",value:"",type:"String"})},methods:{close:function(){this.$emit("close")},refresh:function(){this.$emit("refresh")},changeDefinition:function(t,e){if(""===t.key&&""===t.value)this.$data.definitions.splice(e,1);else if(""!==t.key||""!==t.value){if(this.$data.definitions[e+1])return;"ha-params"==t.key.trim()?t.type="Number":this.definitions.push({key:"",value:"",type:"String"})}},changeDefinitionType:function(t,e){},commonVhosts:function(){var t=this;this.$post(a.a.rabbitMq.commonVhosts,{area:a.a.defaultArea},function(e){e.success?t.virtualHostList=e.data:t.$message.error("获取虚拟机列表失败")})},updatePolicies:function(){var t=this;if(""!=this.policyName&&""!=this.pattern&&""!=this.definitions[0].key){var e=[],s=this;if(this.definitions.forEach(function(t){t.key&&-1==s.defList.indexOf(t.key.trim())&&e.push(t.key.trim())}),e.length>0)this.$message.warning("参数"+e.join(",")+"定义有误，请更正。");else{for(var i={},n=0;n<this.definitions.length;n++)if(""!==this.definitions[n].key||""!==this.definitions[n].value)if("Number"==this.definitions[n].type||"number"==this.definitions[n].type){var o=Number(this.definitions[n].value.trim());if(isNaN(o))return void this.$message.warning("定义中第"+(n+1)+"条"+this.definitions[n].value+"数据类型与选择的不符，请重新选择！");i[this.definitions[n].key.trim()]=Number(this.definitions[n].value.trim())}else i[this.definitions[n].key.trim()]=this.definitions[n].value.trim();this.$post(a.a.rabbitMq.updatePolicies,{area:a.a.defaultArea,policyInfo:{vhost:this.virtualHost,name:this.policyName,pattern:this.pattern,priority:parseInt(this.priority),definition:i,"apply-to":this.applyTo},message:{vhost:this.virtualHost,name:this.policyName,pattern:this.pattern,priority:parseInt(this.priority),definition:i,"apply-to":this.applyTo}},function(e){e.success?(t.$message.success("编辑成功"),setTimeout(function(){t.refresh()},2e3)):t.$message.error("定义参数有误，编辑失败")})}}else this.$message.warning("请填写必填项。")}}},N={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{visible:!0,width:"680px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("span",{staticClass:"dialong-text"},[t._v("编辑policies")]),t._v(" "),s("span",{staticClass:"el-icon-close i-close",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"add-content"},[s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("虚拟主机")]),t._v(" "),s("el-select",{staticClass:"send-short",attrs:{placeholder:"虚拟机名称",clearable:""},model:{value:t.virtualHost,callback:function(e){t.virtualHost=e},expression:"virtualHost"}},t._l(t.virtualHostList,function(t){return s("el-option",{key:t.name,attrs:{value:t.name,label:t.name}})}),1)],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("名称")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.policyName,expression:"policyName"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.policyName},on:{input:function(e){e.target.composing||(t.policyName=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])]),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("模式")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.pattern,expression:"pattern"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.pattern},on:{input:function(e){e.target.composing||(t.pattern=e.target.value)}}}),t._v(" "),s("span",{staticClass:"add-require"},[t._v("*")])]),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("应用范围")]),t._v(" "),s("el-select",{staticClass:"send-select",attrs:{placeholder:"请选择",clearable:""},model:{value:t.applyTo,callback:function(e){t.applyTo=e},expression:"applyTo"}},[s("el-option",{attrs:{value:"all",label:"Exchanges and queues"}}),t._v(" "),s("el-option",{attrs:{value:"exchanges",label:"Exchanges"}}),t._v(" "),s("el-option",{attrs:{value:"queues",label:"Queues"}})],1)],1),t._v(" "),s("div",{staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v("优先级")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.priority,expression:"priority"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:t.priority},on:{input:function(e){e.target.composing||(t.priority=e.target.value)}}})]),t._v(" "),t._l(t.definitions,function(e,a){return s("div",{key:a+"definitions",staticClass:"add-item"},[s("span",{staticClass:"add-title"},[t._v(t._s(0==a?"定义":""))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.key,expression:"item.key"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:e.key},on:{input:[function(s){s.target.composing||t.$set(e,"key",s.target.value)},function(s){return t.changeDefinition(e,a)}]}}),t._v(" "),s("span",{staticClass:"add-equal"},[t._v("=")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],staticClass:"add-ipt",attrs:{type:"text"},domProps:{value:e.value},on:{input:[function(s){s.target.composing||t.$set(e,"value",s.target.value)},function(s){return t.changeDefinition(e,a)}]}}),t._v(" "),s("el-select",{staticClass:"send-shortselect",attrs:{placeholder:"请选择",clearable:""},on:{change:function(s){return t.changeDefinitionType(e,a)}},model:{value:e.type,callback:function(s){t.$set(e,"type",s)},expression:"item.type"}},[s("el-option",{attrs:{label:"String",value:"String"}}),t._v(" "),s("el-option",{attrs:{label:"Number",value:"Number"}})],1),t._v(" "),0==a?s("span",{staticClass:"add-require"},[t._v("*")]):s("span",{staticClass:"add-require"})],1)})],2),t._v(" "),s("div",{staticClass:"definationTable",staticStyle:{padding:"0px 27px 0px 77px"}},[s("div",{staticClass:"definationTip"},[t._v("定义提示:")]),t._v(" "),s("table",[s("tr",{staticStyle:{height:"20px"}},[s("td",{staticStyle:{width:"90px"}},[t._v("HA:")]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            其中之一all:(镜像到集群中的所有节点)、exactly:精确(镜像到一组节点)\n            或nodes:节点(镜像到一个显式节点列表)。如果您选择后两个中的一个，您还必须设置ha-params。\n          ")]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v("ha-mode|")])]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            如果ha-mode是all，则不填;如果ha-mode是exactly,则填一个数字;如果ha-mode是节点nodes，则填写一个字符串列表。\n          ")]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v("ha-params|")])]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            手动manual或自动的automatic。\n          ")]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v("ha-sync-mode")])])],1),t._v(" "),s("tr",{staticStyle:{height:"20px"}},[s("td",{staticStyle:{width:"90px"}},[t._v("Federation:")]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            一个字符串;只有在启用了联合插件的情况下。选择一组upstreams的名称以与联邦一起使用，或选择“all”以使用所有upstreams。与federation-upstream不相容。\n          ")]),t._v(" "),s("td",[t._v("federation-upstream-set|")])]),t._v(" "),s("el-tooltip",{attrs:{effect:"light",placement:"top"}},[s("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n           一个字符串;只有在启用了联合插件的情况下。选择用于联合的特定上游集。与federation-upstream-set不相容。\n          ")]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v("ha-sync-mode")])])],1),t._v(" "),s("tr",{staticStyle:{height:"34px"}},[s("td",{staticStyle:{width:"90px"}},[t._v("Queues:")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[t._v("message-ttl | expires | max-length |max-length-bytes|dead-letter-exchange |dead-letter-routing-key")])]),t._v(" "),s("tr",{staticStyle:{height:"20px"}},[s("td",{staticStyle:{width:"90px"}},[t._v("Exchanges:")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[t._v("alternate-exchange")])])])]),t._v(" "),s("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"cancel-btn",on:{click:t.close}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"save-btn",on:{click:t.updatePolicies}},[t._v("确定")])])])},staticRenderFns:[]};var U={components:{addPolicies:s("VU/8")(k,P,!1,function(t){s("giHB")},"data-v-472692f2",null).exports,editPolicies:s("VU/8")(T,N,!1,function(t){s("31g2")},"data-v-4b92f960",null).exports},data:function(){return{fedTable:[],editPoliyData:"",showAddPolicies:!1,showEditPolicies:!1,checkPolicyName:"",policiesInterVal:null}},mounted:function(){var t=this;this.getPolicies(),this.$data.policiesInterVal=setInterval(function(){t.getPolicies()},3e4)},beforeDestroy:function(){clearInterval(this.$data.policiesInterVal)},methods:{fmt_table_body:function(t,e){var s="";for(var a in console.log("table",t),t)s+=a+e+t[a]+"</br>";return s},handleOpenAddPolic:function(){this.$data.showAddPolicies=!0},policiesRefresh:function(){this.$data.showAddPolicies=!1,this.showEditPolicies=!1,this.getPolicies()},deletePolicies:function(t){var e=this;this.$confirm("确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$post(a.a.rabbitMq.deletePolicies,{area:a.a.defaultArea,policyInfo:{vhost:t.vhost,name:t.name}},function(t){t.success?(e.$message.success("删除策略成功"),e.getPolicies()):e.$message.error("删除策略失败")})})},getPolicies:function(){var t=this;this.$post(a.a.rabbitMq.policies,{area:a.a.defaultArea},function(e){if(e.success)if(t.$data.checkPolicyName){var s=[];e.policies.forEach(function(e){e.name.indexOf(t.$data.checkPolicyName)>=0&&s.push(e)}),t.fedTable=s}else t.fedTable=e.policies;else t.$message.error("获取策略列表失败")})},handleEditPolicies:function(t){this.$data.showEditPolicies=!0,this.$data.editPoliyData=t}}},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"policies-page"},[s("div",[s("div",{staticClass:"connect-head"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checkPolicyName,expression:"checkPolicyName"}],staticClass:"connect-ipt",attrs:{type:"text",placeholder:"policies名称"},domProps:{value:t.checkPolicyName},on:{input:function(e){e.target.composing||(t.checkPolicyName=e.target.value)}}}),t._v(" "),s("span",{staticClass:"iconfont i-search",on:{click:t.getPolicies}},[t._v("")]),t._v(" "),s("div",{staticClass:"add-user"},[s("button",{staticClass:"add-btn add-long",on:{click:t.handleOpenAddPolic}},[t._v("添加Policies")])])]),t._v(" "),s("el-table",{ref:"userTable",staticStyle:{width:"100%"},attrs:{data:t.fedTable,border:""}},[s("el-table-column",{attrs:{prop:"vhost",label:"虚拟主机名称","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"Policies名称","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"pattern",label:"模式","min-width":"160"}}),t._v(" "),s("el-table-column",{attrs:{prop:"apply-to",label:"应用于","min-width":"160"}}),t._v(" "),s("el-table-column",{attrs:{prop:"definition",label:"定义","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{domProps:{innerHTML:t._s(t.fmt_table_body(e.row.definition,":"))}})]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"priority",label:"优先级","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column8",label:"操作","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("button",{staticClass:"edit-btn",on:{click:function(s){return t.handleEditPolicies(e.row)}}},[t._v("编辑")]),t._v(" "),s("button",{staticClass:"delete-btn",on:{click:function(s){return t.deletePolicies(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),t.showAddPolicies?s("add-policies",{on:{close:function(e){t.showAddPolicies=!1},refresh:t.policiesRefresh}}):t._e(),t._v(" "),t.showEditPolicies?s("edit-policies",{attrs:{editPoliy:t.editPoliyData},on:{close:function(e){t.showEditPolicies=!1},refresh:t.policiesRefresh}}):t._e()],1)},staticRenderFns:[]};var V=s("VU/8")(U,S,!1,function(t){s("xHzS")},"data-v-b4ed3bb8",null).exports,D={data:function(){return{fedTable:[],federationsInterVal:null}},mounted:function(){var t=this;this.$refs.fedTable.doLayout(),this.federations(),this.$data.federationsInterVal=setInterval(function(){t.federations()},3e4)},beforeDestroy:function(){clearInterval(this.$data.federationsInterVal)},methods:{federations:function(){var t=this;this.$post(a.a.rabbitMq.federations,{area:a.a.defaultArea},function(e){e.success?t.fedTable=e.data:t.$message.error("获取federation列表失败")})}}},A={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"policies-page"},[s("div",[t._m(0),t._v(" "),s("el-table",{ref:"fedTable",staticStyle:{width:"100%"},attrs:{data:t.fedTable,border:""}},[s("el-table-column",{attrs:{prop:"column1",label:"Upstream","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column2",label:"节点连接","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column3",label:"交换机/队列","min-width":"160"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column4",label:"节点","min-width":"120"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column5",label:"State","min-width":"160"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column6",label:"消息入列率","min-width":"120"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column7",label:"最后一次获取","min-width":"140"}}),t._v(" "),s("el-table-column",{attrs:{prop:"column8",label:"ID","min-width":"140"}})],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"connect-head"},[e("input",{staticClass:"connect-ipt",attrs:{type:"text",placeholder:"Upstream"}}),this._v(" "),e("span",{staticClass:"iconfont i-search"},[this._v("")])])}]};var E={components:{userList:h,virtualHost:$,fedEration:s("VU/8")(D,A,!1,function(t){s("wlyC")},"data-v-42f5b9fc",null).exports,policiesCom:V},data:function(){return{activeTab:1}}},q={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"manager-page"},[s("div",{staticClass:"manager-tabs"},[s("div",{class:1==t.activeTab?"manager-tab active-tab":"manager-tab",on:{click:function(e){t.activeTab=1}}},[t._v("用户")]),t._v(" "),s("div",{class:2==t.activeTab?"manager-tab active-tab":"manager-tab",on:{click:function(e){t.activeTab=2}}},[t._v("虚拟主机")]),t._v(" "),s("div",{class:3==t.activeTab?"manager-tab active-tab":"manager-tab",on:{click:function(e){t.activeTab=3}}},[t._v("Policies")]),t._v(" "),s("div",{class:4==t.activeTab?"manager-tab long-tab active-tab":"manager-tab long-tab",on:{click:function(e){t.activeTab=4}}},[t._v("Federation Status")])]),t._v(" "),1==t.activeTab?s("user-list",{key:"userlist"}):t._e(),t._v(" "),2==t.activeTab?s("virtual-host",{key:"virtualhost"}):t._e(),t._v(" "),3==t.activeTab?s("policies-com",{key:"policies"}):t._e(),t._v(" "),4==t.activeTab?s("fed-eration",{key:"federation"}):t._e()],1)},staticRenderFns:[]};var L=s("VU/8")(E,q,!1,function(t){s("7blE")},"data-v-01fb8394",null);e.default=L.exports},"RZ4/":function(t,e){},WY4Z:function(t,e){},YIME:function(t,e){},bPDp:function(t,e){},giHB:function(t,e){},i1D0:function(t,e){},"iZO/":function(t,e){},"tQ+g":function(t,e){},wlyC:function(t,e){},xHzS:function(t,e){}});