webpackJsonp([16],{URxJ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("P9l9"),s=i("XLwt"),l=i.n(s),o={props:{height:{type:[Number,String],default:320},width:{type:[Number,String],default:600},id:[String],echartsData:[Object]},mounted:function(){},methods:{drawCharts:function(){(window.ActiveXObject||"ActiveXObject"in window?l.a.init(document.getElementById(this.id)):l.a.init(document.getElementById(this.id),null,{renderer:"svg"})).setOption({title:{text:this.echartsData.title,top:10,left:60,textStyle:{color:"#333333",fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis"},xAxis:{type:"category",data:this.echartsData.xAxis},yAxis:{type:"value",axisLabel:{formatter:"{value}次"}},dataZoom:[{type:"inside",start:0,end:10},{start:0,end:10,height:10,handleSize:"80%",backgroundColor:"#FFFFFF",bottom:10,handleStyle:{color:"#D3D9F4",borderType:"solid",borderColor:"#D3D9F4",opacity:1},dataBackground:{lineStyle:{color:"#FFFFFF"},areaStyle:{color:"#FFFFFF",opacity:0}}}],series:[{data:this.echartsData.series[0].data,type:"line",smooth:!0,symbolSize:10,itemStyle:{color:new l.a.graphic.LinearGradient(0,0,1,0,[{offset:0,color:"#0067B6"},{offset:1,color:"#FFA10F"}])},areaStyle:{color:new l.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#4F577C"},{offset:.5,color:"#FFFFFF"},{offset:1,color:"#FFFFFF"}]),opacity:.2}}]})}}},n={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{style:{width:this.width+"px",height:this.height+"px"},attrs:{id:this.id}})},staticRenderFns:[]};var r=i("VU/8")(o,n,!1,function(t){i("i2wx")},"data-v-b2d0d262",null).exports,d={props:{height:{type:[Number,String],default:320},width:{type:[Number,String],default:300},id:[String],echartsData:[Object]},mounted:function(){},methods:{drawCharts:function(){(window.ActiveXObject||"ActiveXObject"in window?l.a.init(document.getElementById(this.id)):l.a.init(document.getElementById(this.id),null,{renderer:"svg"})).setOption({title:{text:this.echartsData.title,top:10,left:20,textStyle:{color:"#333333",fontSize:16,fontWeight:"normal"}},tooltip:{trigger:"axis"},xAxis:{type:"category",data:this.echartsData.xAxis},yAxis:{type:"value",show:!1,axisLabel:{formatter:"{value}次"}},series:[{data:this.echartsData.series[0].data,type:"bar",smooth:!0,symbolSize:10,itemStyle:{color:new l.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#1CA4DC"},{offset:1,color:"#8C94F2"}]),barBorderRadius:[10,10,0,0]},barWidth:20,label:{show:!0,position:"top",distance:10,color:"#333333",fontSize:"12"}}]})}}},c={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{style:{width:this.width+"px",height:this.height+"px"},attrs:{id:this.id}})},staticRenderFns:[]},u=i("VU/8")(d,c,!1,null,null,null).exports,h={props:{buildRow:{type:Object,default:function(){}}},mounted:function(){console.log(this.buildRow),this.buildRow&&(this.getBuildData=this.buildRow)},data:function(){return{getBuildData:{}}},methods:{close:function(){this.$emit("close")},submitbuild:function(){var t=this;this.getBuildData.projectName&&this.$post(a.a.jenkins.jobBuildInfo,{jobName:this.getBuildData.projectName,number:this.getBuildData.version},function(e){e.success?(t.$message.success(e.message),t.$emit("close")):t.$message.error(e.message)})}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"buildPage",attrs:{visible:!0,width:"470px","close-on-press-escape":!1,"show-close":!1,"close-on-click-modal":!1,"append-to-body":""}},[i("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[i("span",[t._v("构建")]),t._v(" "),i("span",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},attrs:{title:"关闭"},on:{click:t.close}})]),t._v(" "),i("div",{staticClass:"buildPage-main"},[t._v("\r\n       是否立即构建？\r\n    ")]),t._v(" "),i("div",{staticClass:"build-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticStyle:{width:"65px"}}),t._v(" "),i("button",{staticClass:"buildButton",staticStyle:{"margin-right":"30px"},attrs:{title:"取消"},on:{click:t.close}},[t._v("取 消")]),t._v(" "),i("button",{staticClass:"buildButton",attrs:{type:"primary",title:"确定"},on:{click:t.submitbuild}},[t._v("确 定")])])])},staticRenderFns:[]};var b={components:{monthBuild:r,buildRank:u,BuildDialog:i("VU/8")(h,m,!1,function(t){i("wHog")},"data-v-04195d21",null).exports},mounted:function(){this.getInit(),this.getMonthBuildCount(),this.getTopFiveRank(),this.getIntervalBuild(),this.randomProgressMethod()},beforeRouteLeave:function(t,e,i){clearInterval(this.getCurrentPoll),i()},data:function(){return{badgeTableShow:!1,randomProgress:0,circleCheckList:[],getCurrentPoll:null,buildData:[],buildInitSave:[],buildTimeStart:"",buildTimeEnd:"",buildDialogShow:!1,buildRow:{},projectName:"",monthData:{title:"构建次数",xAxis:[],series:[]},rankData:{title:"构建排名",xAxis:[],series:[]}}},methods:{badgeClick:function(){this.circleCheckList&&this.circleCheckList.length>0&&(this.badgeTableShow=!this.badgeTableShow)},getIntervalBuild:function(){var t=this;this.getCurrentPoll=setTimeout(function(){t.getCurrentBuildTask()},1e4)},randomProgressMethod:function(){this.randomProgress=Math.floor(95*Math.random())+5},getCurrentBuildTask:function(){var t=this;this.$post(a.a.jenkins.lastBuildInfo,null,function(e){e.success&&e.jenkinsPages&&e.jenkinsPages.length>0?t.circleCheckList=e.jenkinsPages:(t.$message.error(e.message),t.circleCheckList=[]),console.log(e)})},getTopFiveRank:function(){var t=this;t.$post(a.a.jenkins.getTopBuildCount,null,function(e){if(e.success&&e.projectTeam&&e.projectTeam.length>0){t.rankData.xAxis=[],t.rankData.series=[];var i=[],a=[];e.projectTeam.forEach(function(t){i.push(t.projectName),a.push(t.lastMonthCount)}),console.log(i,a),t.rankData.xAxis=i,t.rankData.series.push({name:"构建排名",data:a}),console.log(t.rankData),t.$refs.buildrank.drawCharts()}else t.$message.error(e.message),t.rankData.xAxis=[],t.rankData.series=[],t.$refs.buildrank.drawCharts()})},getMonthBuildCount:function(){var t=this;t.$post(a.a.jenkins.getLastMonthCount,null,function(e){if(e.success&&e.projectCount&&e.projectCount.length>0){t.monthData.xAxis=[],t.monthData.series=[];var i=[],a=[];e.projectCount.forEach(function(t){i.push(t.projectName),a.push(t.lastMonthCount)}),console.log(i,a),t.monthData.xAxis=i,t.monthData.series.push({title:"构建次数",data:a}),console.log(t.monthData),t.$refs.monthbuild.drawCharts()}else t.$message.error(e.message),t.monthData.xAxis=[],t.monthData.series=[],t.$refs.monthbuild.drawCharts()})},buildTimeChange:function(){this.buildTimeStart=null==this.buildTimeStart?"":this.buildTimeStart,this.buildTimeEnd=null==this.buildTimeEnd?"":this.buildTimeEnd,""!=this.buildTimeStart&&""!=this.buildTimeEnd&&this.buildTimeStart>this.buildTimeEnd&&this.$message.warning("构建开始时间不能大于构建结束时间！")},buildDilogClose:function(){this.buildDialogShow=!1,this.getInit()},handleBuild:function(t){this.buildDialogShow=!0,this.buildRow=t,console.log(this.buildRow)},getInit:function(){var t=this;this.$post(a.a.jenkins.getJobInfo,{},function(e){e.success?(console.log(e),t.buildData=e.buildTasksList,t.buildInitSave=e.buildTasksList):(t.$message.error(e.message),t.buildData=[],t.buildInitSave=[])})},tableSearch:function(){var t=this;if(this.buildTimeStart=null==this.buildTimeStart?"":this.buildTimeStart,this.buildTimeEnd=null==this.buildTimeEnd?"":this.buildTimeEnd,console.log("start:",this.buildTimeStart,"end:",this.buildTimeEnd),this.buildInitSave&&this.buildInitSave.length>0){if(""!=this.projectName&&""==this.buildTimeStart&&""==this.buildTimeEnd)this.buildData=this.buildInitSave.filter(function(e){if(e.projectName&&e.projectName.indexOf(t.projectName)>-1)return e}),console.log("first");else if(""==this.projectName&&""!=this.buildTimeStart&&""==this.buildTimeEnd){var e=this.buildTimeStart+" 00:00:00";this.buildData=this.buildInitSave.filter(function(t){if(t.latelyTime&&t.latelyTime>=e)return t}),console.log("second")}else if(""==this.projectName&&""==this.buildTimeStart&&""!=this.buildTimeEnd){var i=this.buildTimeEnd+" 23:59:59";this.buildData=this.buildInitSave.filter(function(t){if(t.latelyTime&&t.latelyTime<=i)return t}),console.log("third")}else if(""==this.projectName&&""!=this.buildTimeStart&&""!=this.buildTimeEnd){var a=this.buildTimeStart+" 00:00:00",s=this.buildTimeEnd+" 23:59:59";this.buildData=this.buildInitSave.filter(function(t){if(t.latelyTime&&t.latelyTime>=a&&t.latelyTime<=s)return t}),console.log("four")}else if(""!=this.projectName&&""!=this.buildTimeStart&&""==this.buildTimeEnd){var l=this.buildTimeStart+" 00:00:00";this.buildData=this.buildInitSave.filter(function(e){if(e.projectName&&e.projectName.indexOf(t.projectName)>-1&&e.latelyTime&&e.latelyTime>=l)return e}),console.log("five")}else if(""==this.projectName&&""==this.buildTimeStart&&""==this.buildTimeEnd)this.buildData=this.buildInitSave,console.log("last");else if(""!=this.projectName&&""==this.buildTimeStart&&""!=this.buildTimeEnd){var o=this.buildTimeEnd+" 23:59:59";this.buildData=this.buildInitSave.filter(function(e){if(e.projectName&&e.projectName.indexOf(t.projectName)>-1&&e.latelyTime&&e.latelyTime<=o)return e}),console.log("seven")}else if(""!=this.projectName&&""!=this.buildTimeStart&&""!=this.buildTimeEnd){var n=this.buildTimeStart+" 00:00:00",r=this.buildTimeEnd+" 23:59:59";this.buildData=this.buildInitSave.filter(function(e){if(e.projectName&&e.projectName.indexOf(t.projectName)>-1&&e.latelyTime&&e.latelyTime>=n&&e.latelyTime<=r)return e})}console.log(this.buildData)}},statusFormatter:function(t){return"SUCCESS"==t.status?"成功":"失败"},handleCurrentChange:function(t){this.$data.pagination.page=t},handleDetailPage:function(t){this.$router.push({path:"/builddetail",query:{projectName:t.projectName}}),console.log(t.projectName)}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"test-page"},[i("el-scrollbar",{staticClass:"test-scroll"},[i("div",{staticClass:"test-charts"},[i("div",{staticClass:"charts-left"},[i("div",{staticClass:"charts-head"},[t._v("月构建次数统计")]),t._v(" "),i("month-build",{ref:"monthbuild",attrs:{id:"monthchart",echartsData:t.monthData,width:"100%",height:"320"}})],1),t._v(" "),i("div",{staticClass:"charts-right"},[i("div",{staticClass:"charts-head"},[t._v("TOP5项目构建数排名")]),t._v(" "),i("build-rank",{ref:"buildrank",attrs:{id:"toprank",echartsData:t.rankData,width:"100%",height:"320"}})],1)]),t._v(" "),i("div",{staticClass:"wait-build"},[i("div",{staticClass:"charts-head"},[i("div",{staticClass:"charts-head-left"},[t._v("待构建列表")]),t._v(" "),i("div",{staticClass:"charts-head-right"},[i("span",{staticClass:"iconfont RectCheck",on:{click:t.badgeClick}},[t._v("")]),t._v(" "),t.circleCheckList&&t.circleCheckList.length>0?i("div",{staticClass:"itemBadge"},[i("span",{staticStyle:{}},[t._v(t._s(t.circleCheckList.length))])]):t._e(),t._v(" "),t.badgeTableShow?i("div",{staticClass:"badge-table"},t._l(t.circleCheckList,function(e,a){return i("div",{key:a,staticClass:"badge-table-item",attrs:{value:e.value}},[t.circleCheckList&&t.circleCheckList.length>0?i("div",{staticClass:"badge-table-item-top"},[i("div",{staticClass:"itemCheckedIndex"},[t._v(t._s(a+1))]),t._v(" "),i("div",{staticClass:"itemDisplayName"},[t._v(t._s(e.fullDisplayName))]),t._v(" "),i("div",{staticClass:"itemBuilding"},[t._v(t._s(e.displayName))])]):t._e(),t._v(" "),t.circleCheckList&&t.circleCheckList.length>0?i("div",{staticClass:"badge-table-item-bottom"},[e.building?i("el-progress",{attrs:{"stroke-width":6,percentage:100,"show-text":!1}}):t._e(),t._v(" "),0==e.building?i("el-progress",{attrs:{"stroke-width":6,percentage:t.randomProgress,"show-text":!1}}):t._e()],1):t._e()])}),0):t._e()])]),t._v(" "),i("div",{staticClass:"wait-table"},[i("div",{staticClass:"wait-item"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.projectName,expression:"projectName"}],staticClass:"wait-ipt",attrs:{type:"text",placeholder:"请输入项目名称"},domProps:{value:t.projectName},on:{input:function(e){e.target.composing||(t.projectName=e.target.value)}}}),t._v(" "),i("el-date-picker",{staticClass:"time-range",attrs:{type:"date",placeholder:"构建时间起","value-format":"yyyy-MM-dd"},on:{change:t.buildTimeChange},model:{value:t.buildTimeStart,callback:function(e){t.buildTimeStart=e},expression:"buildTimeStart"}}),t._v(" "),i("el-date-picker",{staticClass:"time-range",attrs:{type:"date",placeholder:"构建时间止","value-format":"yyyy-MM-dd"},on:{change:t.buildTimeChange},model:{value:t.buildTimeEnd,callback:function(e){t.buildTimeEnd=e},expression:"buildTimeEnd"}}),t._v(" "),i("div",{staticClass:"time-range search-area"},[i("span",{staticClass:"iconfont i-search",on:{click:t.tableSearch}},[t._v("")])])],1),t._v(" "),i("el-table",{ref:"historyTable",staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.buildData,border:"",height:"470"}},[i("el-table-column",{attrs:{prop:"projectName",label:"项目名称","min-width":"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"latelyTime",label:"构建时间","min-width":"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"status",label:"构建结果","min-width":"120",formatter:t.statusFormatter}}),t._v(" "),i("el-table-column",{attrs:{prop:"status",label:"静态代码审核结果","min-width":"140",formatter:t.statusFormatter}}),t._v(" "),i("el-table-column",{attrs:{prop:"status",label:"单元测试结果","min-width":"130",formatter:t.statusFormatter}}),t._v(" "),i("el-table-column",{attrs:{prop:"status",label:"验证测试结果","min-width":"130",formatter:t.statusFormatter}}),t._v(" "),i("el-table-column",{attrs:{prop:"column7",label:"操作","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("button",{staticClass:"build-btn",on:{click:function(i){return t.handleBuild(e.row)}}},[t._v("构建")]),t._v(" "),i("button",{staticClass:"detail-btn",on:{click:function(i){return t.handleDetailPage(e.row)}}},[t._v("详情")])]}}])})],1)],1)]),t._v(" "),t.buildDialogShow?i("BuildDialog",{attrs:{buildRow:t.buildRow},on:{close:t.buildDilogClose}}):t._e()],1)],1)},staticRenderFns:[]};var g=i("VU/8")(b,p,!1,function(t){i("Ucor")},"data-v-1076685b",null);e.default=g.exports},Ucor:function(t,e){},i2wx:function(t,e){},wHog:function(t,e){}});