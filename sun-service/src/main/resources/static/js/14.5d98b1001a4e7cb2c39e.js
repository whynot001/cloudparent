webpackJsonp([14],{aeIy:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("P9l9"),s={props:{editRow:{type:Object,default:{}}},mounted:function(){this.getParentData()},data:function(){return{getEditRow:null,developGroupOptions:[],roleOptions:[],editRoleForm:{roleName:null,remark:null}}},methods:{getParentData:function(){this.editRow&&(this.getEditRow=this.editRow,this.editRoleForm.roleName=this.getEditRow.roleName,this.editRoleForm.remark=this.getEditRow.remark,console.log(this.getEditRow))},submitEdit:function(){var t=this,e={};if(this.editRoleForm){if((e=this.editRoleForm).menuIdList=this.getEditRow.menuIdList?this.getEditRow.menuIdList:[],e.roleId=this.getEditRow.roleId,!e.roleName)return void this.$message.warning("角色名称不能为空！");if(!e.remark)return void this.$message.warning("角色描述不能为空！");this.$post(a.a.systemManager.updataRole,e,function(e){0===e.code?(t.$message.success("编辑角色成功！"),t.$emit("closeEdit")):t.$message.error(e.msg)})}},closeEdit:function(){this.$emit("closeEdit")}}},i={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{staticClass:"editRoleDialog",attrs:{visible:!0,width:"470px","close-on-press-escape":!1,"show-close":!1,"close-on-click-modal":!1,"append-to-body":""}},[o("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[o("span",[t._v("编辑角色")]),t._v(" "),o("span",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},attrs:{title:"关闭"},on:{click:t.closeEdit}})]),t._v(" "),o("div",{staticClass:"editRoleDialog_form"},[o("div",{staticClass:"form_item"},[o("div",{staticClass:"form_item_left"},[o("span",{staticClass:"star"},[t._v("*")]),o("span",{staticClass:"form_item_label"},[t._v("角色名称")])]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.editRoleForm.roleName,expression:"editRoleForm.roleName"}],staticClass:"form_input",attrs:{type:"text",placeholder:"请输入"},domProps:{value:t.editRoleForm.roleName},on:{input:function(e){e.target.composing||t.$set(t.editRoleForm,"roleName",e.target.value)}}})]),t._v(" "),o("div",{staticClass:"form_item2"},[o("div",{staticClass:"form_item_left"},[o("span",{staticClass:"star"},[t._v("*")]),o("span",{staticClass:"form_item_label"},[t._v("角色描述")])]),t._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editRoleForm.remark,expression:"editRoleForm.remark"}],staticClass:"form_textarea",attrs:{type:"text",placeholder:"请输入"},domProps:{value:t.editRoleForm.remark},on:{input:function(e){e.target.composing||t.$set(t.editRoleForm,"remark",e.target.value)}}})])]),t._v(" "),o("div",{staticClass:"editRoleDialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("div",{staticStyle:{width:"65px"}}),t._v(" "),o("button",{staticClass:"editDialogButton",staticStyle:{"margin-right":"30px"},attrs:{title:"取消"},on:{click:t.closeEdit}},[t._v("取 消")]),t._v(" "),o("button",{staticClass:"editDialogButton",attrs:{type:"primary",title:"确定"},on:{click:t.submitEdit}},[t._v("确 定")])])])},staticRenderFns:[]};var l=o("VU/8")(s,i,!1,function(t){o("lS0/")},null,null).exports,r={props:{ResourceGrantRow:{type:Object,default:function(){}}},mounted:function(){this.ResourceGrantRow&&(this.getResourceGrantRow=this.ResourceGrantRow,this.getResourceList()),console.log(this.getResourceGrantRow)},data:function(){return{defaultCheckedArr:[],getResourceGrantRow:null,resourcedata:[],defaultProps:{children:"children",label:"name"},multipleSelection:[]}},methods:{getTreeVal:function(t){var e=[];this.$refs.resourceTree.getCheckedNodes().forEach(function(t){e.push(t.id)}),this.multipleSelection=e,console.log("arr",this.multipleSelection)},submitGrant:function(){var t=this,e={};e.menuIdList=this.multipleSelection?this.multipleSelection:[],e.roleId=this.getResourceGrantRow.roleId,this.$post(a.a.systemManager.authmenu,e,function(e){0===e.code?(t.$message.success("资源授权成功!"),t.multipleSelection=[],t.resourcedata=[],t.$emit("closeResGrantDialog")):t.$message.error(e.msg)})},getResourceList:function(){var t=this;this.$get(a.a.systemManager.menulistTree+"/"+this.getResourceGrantRow.roleId,null,function(e){0===e.code?(t.resourcedata=e.tree,t.defaultCheckedArr=e.menuIds,console.log(t.resourcedata)):t.$message.error(e.msg)})},closeGrant:function(){this.$emit("closeResGrantDialog"),this.multipleSelection=[]}}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{staticClass:"editUserDialog",attrs:{visible:!0,width:"350px","close-on-press-escape":!1,"show-close":!1,"close-on-click-modal":!1,"append-to-body":""}},[o("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[o("span",[t._v("资源授权")]),t._v(" "),o("span",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},attrs:{title:"关闭"},on:{click:t.closeGrant}})]),t._v(" "),o("el-tree",{ref:"resourceTree",attrs:{data:t.resourcedata,"show-checkbox":"","node-key":"id","default-expand-all":!0,props:t.defaultProps,"default-checked-keys":t.defaultCheckedArr},on:{"check-change":t.getTreeVal}}),t._v(" "),o("div",{staticClass:"editUserDialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("div",{staticStyle:{width:"65px"}}),t._v(" "),o("button",{staticClass:"editDialogButton",staticStyle:{"margin-right":"30px"},attrs:{title:"取消"},on:{click:t.closeGrant}},[t._v("取 消")]),t._v(" "),o("button",{staticClass:"editDialogButton",attrs:{type:"primary",title:"确定"},on:{click:t.submitGrant}},[t._v("确 定")])])],1)},staticRenderFns:[]};var c={props:{},components:{EditDialog:l,ResourceGrant:o("VU/8")(r,n,!1,function(t){o("lPhW")},null,null).exports},mounted:function(){this.getRoleInit()},data:function(){return{ResourceGrantShow:!1,editRow:{},editDialogShow:!1,developGroupOptions:[],roleOptions:[],roleForm:{roleName:null},roletableData:[],pagination:{page:1,total:30,size:10},newroleDialog:!1,addroleForm:{roleName:null,remark:null}}},methods:{getRoleInit:function(){var t=this,e=this,o={};o.page=e.pagination.page,o.limit=e.pagination.size,o.roleName=e.roleForm.roleName,e.$post(a.a.systemManager.roleList,o,function(o){0===o.code?(e.roletableData=o.page.list,e.pagination.total=Number(o.page.totalCount)):t.$message.error(o.msg)})},closeResGrantDialog:function(){this.ResourceGrantShow=!1,this.getRoleInit()},roleSearch:function(){this.getRoleInit()},grantHandle:function(t,e){this.ResourceGrantShow=!0,this.ResourceGrantRow=e,console.log(this.ResourceGrantRow)},closeEdit:function(){this.editDialogShow=!1,this.getRoleInit()},editHandle:function(t,e){this.editDialogShow=!0,this.editRow=e,console.log(this.editRow)},deleteHandle:function(t,e){var o=this;console.log(e);var s=[];s.push(e.roleId),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.$post(a.a.systemManager.deleteRole,s,function(e){0===e.code?(o.roletableData.splice(t,1),o.$message.success("删除成功！"),o.getRoleInit(),console.log(e)):o.$message.error(e.msg)})})},handleCurrentChange:function(t){this.pagination.page=t,this.getRoleInit()},closeAddrole:function(){this.newroleDialog=!1,this.addroleForm={}},newroleDialogSubmit:function(){var t=this,e={};if(this.addroleForm){if(!(e=this.addroleForm).roleName)return void this.$message.warning("角色名称不能为空！");if(!e.remark)return void this.$message.warning("角色描述不能为空！");e.menuIdList=[],this.$post(a.a.systemManager.newRoleSave,e,function(e){0===e.code?(t.$message.success("新增角色成功！"),t.newroleDialog=!1,t.addroleForm={},t.getRoleInit()):t.$message.error(e.msg)})}},addroleHandle:function(){this.newroleDialog=!0}}},d={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"systemsRoleManage"},[o("div",{staticClass:"systemsManage_search"},[o("div",{staticClass:"systemsManage_search_left-wrap"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.roleForm.roleName,expression:"roleForm.roleName"}],staticClass:"searchInput",staticStyle:{"margin-right":"20px"},attrs:{placeholder:"角色名称"},domProps:{value:t.roleForm.roleName},on:{input:function(e){e.target.composing||t.$set(t.roleForm,"roleName",e.target.value)}}}),t._v(" "),o("div",{staticClass:"search_icon"},[o("span",{staticClass:"el-icon-search",attrs:{title:"搜索"},on:{click:t.roleSearch}})])]),t._v(" "),o("div",{staticClass:"addrole",on:{click:t.addroleHandle}},[t._v("\n      添加\n    ")])]),t._v(" "),o("el-table",{ref:"roletableData",staticClass:"systemsManage_table",staticStyle:{width:"100%"},attrs:{data:t.roletableData,border:"",height:"441"}},[o("el-table-column",{attrs:{prop:"roleName",label:"角色名称","min-width":"300"}}),t._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"角色描述","min-width":"300"}}),t._v(" "),o("el-table-column",{attrs:{prop:"dat7",label:"操作","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("button",{staticClass:"tablebutton grantButton",attrs:{title:"授权"},on:{click:function(o){return t.grantHandle(e.$index,e.row)}}},[t._v("授权")]),t._v(" "),o("button",{staticClass:"tablebutton editBut",attrs:{title:"编辑"},on:{click:function(o){return t.editHandle(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),o("button",{staticClass:"tablebutton deleteBut",attrs:{title:"删除"},on:{click:function(o){return t.deleteHandle(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),o("div",{staticClass:"pagination"},[o("div",{staticClass:"pagination-left"},[o("el-pagination",{attrs:{"current-page":t.pagination.page,"page-size":t.pagination.size,layout:"total, prev, pager, next, jumper",total:t.pagination.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),o("div",{staticClass:"pagination-right"},[t._v("\n      当前显示"+t._s((t.pagination.page-1)*t.pagination.size+1)+"-"+t._s((t.pagination.page-1)*t.pagination.size+t.roletableData.length)+"条记录 "),o("span",[t._v("共"+t._s(t.pagination.total)+"条记录")])])]),t._v(" "),o("el-dialog",{staticClass:"addroleDialog",attrs:{visible:t.newroleDialog,width:"470px","close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1,"append-to-body":""},on:{"update:visible":function(e){t.newroleDialog=e}}},[o("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[o("span",[t._v("添加角色")]),t._v(" "),o("span",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},attrs:{title:"关闭"},on:{click:t.closeAddrole}})]),t._v(" "),o("div",{staticClass:"newroleDialog_form"},[o("div",{staticClass:"form_item"},[o("div",{staticClass:"form_item_left"},[o("span",{staticClass:"star"},[t._v("*")]),o("span",{staticClass:"form_item_label"},[t._v("角色名称")])]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.addroleForm.roleName,expression:"addroleForm.roleName"}],staticClass:"form_input",attrs:{type:"text",placeholder:"请输入"},domProps:{value:t.addroleForm.roleName},on:{input:function(e){e.target.composing||t.$set(t.addroleForm,"roleName",e.target.value)}}})]),t._v(" "),o("div",{staticClass:"form_item2"},[o("div",{staticClass:"form_item_left"},[o("span",{staticClass:"star"},[t._v("*")]),o("span",{staticClass:"form_item_label"},[t._v("角色描述")])]),t._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.addroleForm.remark,expression:"addroleForm.remark"}],staticClass:"form_textarea",attrs:{type:"text",placeholder:"请输入"},domProps:{value:t.addroleForm.remark},on:{input:function(e){e.target.composing||t.$set(t.addroleForm,"remark",e.target.value)}}})])]),t._v(" "),o("span",{staticClass:"newroleDialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("button",{staticClass:"newDialogButton",staticStyle:{"margin-right":"30px"},attrs:{title:"取消"},on:{click:t.closeAddrole}},[t._v("取 消")]),t._v(" "),o("button",{staticClass:"newDialogButton",attrs:{type:"primary",title:"确定"},on:{click:t.newroleDialogSubmit}},[t._v("确 定")])])]),t._v(" "),t.editDialogShow?[o("EditDialog",{attrs:{editRow:t.editRow},on:{closeEdit:t.closeEdit}})]:t._e(),t._v(" "),t.ResourceGrantShow?[o("ResourceGrant",{attrs:{ResourceGrantRow:t.ResourceGrantRow},on:{closeResGrantDialog:t.closeResGrantDialog}})]:t._e()],2)},staticRenderFns:[]};var u=o("VU/8")(c,d,!1,function(t){o("dDyy")},"data-v-195e27b0",null);e.default=u.exports},dDyy:function(t,e){},lPhW:function(t,e){},"lS0/":function(t,e){}});