webpackJsonp([17],{GnVb:function(a,t){},HdI0:function(a,t){},Wk1P:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("P9l9"),l={data:function(){return{alarmClass:null,alarmType:null,alarmTypeName:null,alarmValue:null,alarmTypeList:[],alarmTemplateId:null}},methods:{submit:function(){var a=this;this.$data.alarmClass?this.$data.alarmType?this.$data.alarmValue?(this.$data.alarmType&&this.alarmTypeList.forEach(function(t){t.alarmType!=a.$data.alarmType||(a.alarmTypeName=t.alarmTypeName)}),this.$post(s.a.alarm.addAlarmConfig,{alarmClass:this.$data.alarmClass,alarmType:this.$data.alarmType,alarmName:this.alarmTypeName,informLevel:"告警",templateId:this.$data.alarmTemplateId,alarmValue:this.$data.alarmValue,state:1},function(t){0===t.code?(a.$message.success("添加成功"),a.refresh()):a.$message.error(t.msg)})):this.$message.warning("请输入告警值！"):this.$message.warning("请选择告警类型！"):this.$message.warning("请选择消息类型！")},getAlarmTemplateId:function(){var a=this;this.$post(s.a.alarm.getAlarmTypeSelect,{alarmClass:this.$data.alarmClass,alarmType:this.$data.alarmType},function(t){t.data&&(a.$data.alarmTemplateId=t.data[0].id)})},getAlarmTypeList:function(){var a=this;this.$post(s.a.alarm.getAlarmTypeSelect,{alarmClass:this.$data.alarmClass,alarmType:this.$data.alarmType},function(t){a.$data.alarmTypeList=t.data})},close:function(){this.$emit("close")},refresh:function(){this.alarmClass=null,this.alarmType=null,this.alarmTypeName=null,this.alarmValue=null,this.alarmTypeList=[],this.$emit("refresh")}}},i={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("el-dialog",{attrs:{visible:!0,width:"410px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[e("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e("span",{staticClass:"dialong-text"},[a._v("添加阀值")]),a._v(" "),e("span",{staticClass:"el-icon-close i-close",attrs:{title:"关闭"},on:{click:a.close}})]),a._v(" "),e("div",{staticClass:"send-content"},[e("div",{staticClass:"send-item"},[e("div",{staticClass:"item-left"},[e("span",{staticClass:"send-title"},[e("span",{staticClass:"star"},[a._v("*")]),a._v("消息类型")])]),a._v(" "),e("el-select",{staticClass:"search-select",attrs:{placeholder:"消息类型",clearable:""},on:{change:a.getAlarmTypeList},model:{value:a.alarmClass,callback:function(t){a.alarmClass=t},expression:"alarmClass"}},[e("el-option",{attrs:{value:"rabbitmq",label:"rabbitmq"}}),a._v(" "),e("el-option",{attrs:{value:"activemq",label:"activemq"}}),a._v(" "),e("el-option",{attrs:{value:"twemproxy",label:"twemproxy"}}),a._v(" "),e("el-option",{attrs:{value:"memcached",label:"memcached"}}),a._v(" "),e("el-option",{attrs:{value:"codis",label:"codis"}}),a._v(" "),e("el-option",{attrs:{value:"jenkins",label:"jenkins"}})],1)],1),a._v(" "),e("div",{staticClass:"send-item"},[e("div",{staticClass:"item-left"},[e("span",{staticClass:"send-title"},[e("span",{staticClass:"star"},[a._v("*")]),a._v("告警类型")])]),a._v(" "),e("el-select",{staticClass:"search-select",attrs:{placeholder:"告警类型",clearable:""},on:{change:a.getAlarmTemplateId},model:{value:a.alarmType,callback:function(t){a.alarmType=t},expression:"alarmType"}},a._l(a.alarmTypeList,function(a){return e("el-option",{key:a.id,attrs:{label:a.alarmTypeName,value:a.alarmType}})}),1)],1),a._v(" "),e("div",{staticClass:"send-item"},[e("div",{staticClass:"item-left"},[e("span",{staticClass:"send-title"},[e("span",{staticClass:"star"},[a._v("*")]),a._v("告警值")])]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.alarmValue,expression:"alarmValue"}],staticClass:"send-ipt",attrs:{type:"text",placeholder:"告警值"},domProps:{value:a.alarmValue},on:{input:function(t){t.target.composing||(a.alarmValue=t.target.value)}}})])]),a._v(" "),e("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[e("button",{staticClass:"cancel-btn",attrs:{title:"取消"},on:{click:a.close}},[a._v("取消")]),a._v(" "),e("button",{staticClass:"save-btn",attrs:{title:"确定"},on:{click:a.submit}},[a._v("确定")])])])},staticRenderFns:[]};var n=e("VU/8")(l,i,!1,function(a){e("HdI0")},"data-v-f2386344",null).exports,r={data:function(){return{getParentData:{},alarmClass:null,alarmType:null,alarmValue:null,alarmTypeList:[],alarmTemplateId:null}},props:{showSettingRow:{type:Object,default:function(){}}},mounted:function(){console.log(this.showSettingRow),this.getParent()},methods:{getParent:function(){this.showSettingRow&&(this.getParentData=this.showSettingRow,this.alarmClass=this.getParentData.alarmClass,this.alarmType=this.getParentData.alarmType,this.alarmValue=this.getParentData.alarmValue,this.getAlarmTypeList())},getAlarmTypeList:function(){var a=this;this.$post(s.a.alarm.getAlarmTypeSelect,{alarmClass:this.$data.alarmClass},function(t){a.$data.alarmTypeList=t.data})},submit:function(){var a=this;this.$data.alarmValue?this.$post(s.a.alarm.updateAlarmConfig,{id:this.getParentData.id,alarmValue:this.$data.alarmValue},function(t){0===t.code?(a.$message.success("编辑成功"),a.$emit("closeSettingDialog")):a.$message.error(t.msg)}):this.$message.warning("请输入告警值！")},close:function(){this.$emit("closeSettingDialog")}}},o={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("el-dialog",{attrs:{visible:!0,width:"410px","close-on-press-escape":!1,"show-close":!1,"append-to-body":""}},[e("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e("span",{staticClass:"dialong-text"},[a._v("预警值设置")]),a._v(" "),e("span",{staticClass:"el-icon-close i-close",attrs:{title:"关闭"},on:{click:a.close}})]),a._v(" "),e("div",{staticClass:"send-content"},[e("div",{staticClass:"send-item"},[e("div",{staticClass:"item-left"},[e("span",{staticClass:"send-title"},[e("span",{staticClass:"star"}),a._v("消息类型")])]),a._v(" "),e("el-select",{staticClass:"search-select",attrs:{placeholder:"消息类型",clearable:"",disabled:""},on:{change:a.getAlarmTypeList},model:{value:a.alarmClass,callback:function(t){a.alarmClass=t},expression:"alarmClass"}},[e("el-option",{attrs:{value:"rabbitmq",label:"rabbitmq"}}),a._v(" "),e("el-option",{attrs:{value:"activemq",label:"activemq"}}),a._v(" "),e("el-option",{attrs:{value:"memcached",label:"memcached"}}),a._v(" "),e("el-option",{attrs:{value:"redis",label:"redis"}}),a._v(" "),e("el-option",{attrs:{value:"jenkins",label:"jenkins"}})],1)],1),a._v(" "),e("div",{staticClass:"send-item"},[e("div",{staticClass:"item-left"},[e("span",{staticClass:"send-title"},[e("span",{staticClass:"star"}),a._v("告警类型")])]),a._v(" "),e("el-select",{staticClass:"search-select",attrs:{placeholder:"告警类型",clearable:"",disabled:""},model:{value:a.alarmType,callback:function(t){a.alarmType=t},expression:"alarmType"}},a._l(a.alarmTypeList,function(a){return e("el-option",{key:a.id,attrs:{label:a.alarmTypeName,value:a.alarmType}})}),1)],1),a._v(" "),e("div",{staticClass:"send-item"},[e("div",{staticClass:"item-left"},[e("span",{staticClass:"send-title"},[e("span",{staticClass:"star"},[a._v("*")]),a._v("告警值")])]),a._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:a.alarmValue,expression:"alarmValue"}],staticClass:"send-ipt",attrs:{type:"text"},domProps:{value:a.alarmValue},on:{input:function(t){t.target.composing||(a.alarmValue=t.target.value)}}})])]),a._v(" "),e("div",{staticClass:"send-confirm",attrs:{slot:"footer"},slot:"footer"},[e("button",{staticClass:"cancel-btn",attrs:{title:"取消"},on:{click:a.close}},[a._v("取消")]),a._v(" "),e("button",{staticClass:"save-btn",attrs:{title:"确定"},on:{click:a.submit}},[a._v("确定")])])])},staticRenderFns:[]};var c={components:{addValve:n,settingValve:e("VU/8")(r,o,!1,function(a){e("GnVb")},"data-v-eb503794",null).exports},mounted:function(){this.getAlarmConfigList()},data:function(){return{showSettingRow:{},searchForam:{informType:null,alarmClass:null},pagination:{page:1,total:30,size:10},tableParam:{messageType:"",nodeName:"",noticeType:""},settingData:[],showAddDialog:!1,showSettingDialog:!1}},methods:{closeSettingDialog:function(){this.$data.showSettingDialog=!1,this.getAlarmConfigList()},query:function(){this.pagination.page=1,this.getAlarmConfigList()},handleCurrentChange:function(a){this.$data.pagination.page=a,this.getAlarmConfigList()},handleOpenAdd:function(){this.$data.showAddDialog=!0},handleOpenSetting:function(a){this.$data.showSettingDialog=!0,this.showSettingRow=a,console.log(this.showSettingRow)},getAlarmConfigList:function(){var a=this;this.$data.showAddDialog=!1,this.$post(s.a.alarm.list,{page:this.pagination.page,limit:this.pagination.size,informType:this.searchForam.informType?this.searchForam.informType:null,alarmClass:this.searchForam.alarmClass?this.searchForam.alarmClass:null},function(t){0===t.code&&(a.$data.settingData=t.page.list,a.pagination.total=Number(t.page.totalCount))})},deleteAlarmConfig:function(){this.$post(s.a.alarm.deleteAlarmConfig,{},function(a){})}}},m={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"setting-page"},[e("div",{staticClass:"setting-head"},[e("el-select",{staticClass:"search-select search-right",attrs:{placeholder:"信息类型",clearable:""},model:{value:a.searchForam.alarmClass,callback:function(t){a.$set(a.searchForam,"alarmClass",t)},expression:"searchForam.alarmClass"}},[e("el-option",{attrs:{value:"rabbitmq",label:"rabbitmq"}}),a._v(" "),e("el-option",{attrs:{value:"activemq",label:"activemq"}}),a._v(" "),e("el-option",{attrs:{value:"twemproxy",label:"twemproxy"}}),a._v(" "),e("el-option",{attrs:{value:"memcached",label:"memcached"}}),a._v(" "),e("el-option",{attrs:{value:"codis",label:"codis"}}),a._v(" "),e("el-option",{attrs:{value:"jenkins",label:"jenkins"}})],1),a._v(" "),e("el-select",{staticClass:"search-select search-right",attrs:{placeholder:"通知类型",clearable:""},model:{value:a.searchForam.informType,callback:function(t){a.$set(a.searchForam,"informType",t)},expression:"searchForam.informType"}},[e("el-option",{attrs:{value:"邮件",label:"邮件"}}),a._v(" "),e("el-option",{attrs:{value:"短信",label:"短信"}})],1),a._v(" "),e("span",{staticClass:"iconfont i-search",attrs:{title:"搜索"},on:{click:a.query}},[a._v("")]),a._v(" "),e("div",{staticClass:"head-oper"},[e("button",{staticClass:"add-btn",attrs:{title:"添加阀值"},on:{click:a.handleOpenAdd}},[a._v("添加阀值")])])],1),a._v(" "),e("el-table",{ref:"historyTable",staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:a.settingData,border:""}},[e("el-table-column",{attrs:{prop:"alarmClass",label:"消息类型","min-width":"140"}}),a._v(" "),e("el-table-column",{attrs:{prop:"alarmTypeName",label:"告警类型","min-width":"140"}}),a._v(" "),e("el-table-column",{attrs:{prop:"alarmValue",label:"告警值","min-width":"140"}}),a._v(" "),e("el-table-column",{attrs:{prop:"informType",label:"通知类型","min-width":"140"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v("\n        "+a._s(t.row.informType&&t.row.informType.substr(-1,1).indexOf(",")>-1?t.row.informType.substr(0,t.row.informType.length-1):t.row.informType)+"\n      ")]}}])}),a._v(" "),e("el-table-column",{attrs:{prop:"column5",label:"操作","min-width":"140"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("button",{staticClass:"set-btn",attrs:{title:"阀值设置"},on:{click:function(e){return a.handleOpenSetting(t.row)}}},[a._v("阀值设置")])]}}])})],1),a._v(" "),e("div",{staticClass:"pagination"},[e("div",{staticClass:"pagination-left"},[e("el-pagination",{attrs:{"current-page":a.pagination.page,"page-size":a.pagination.size,layout:"total, prev, pager, next, jumper",total:a.pagination.total},on:{"current-change":a.handleCurrentChange}})],1),a._v(" "),e("div",{staticClass:"pagination-right"},[a._v("\n      当前显示"+a._s((a.pagination.page-1)*a.pagination.size+1)+"-"+a._s((a.pagination.page-1)*a.pagination.size+a.settingData.length)+"条记录 "),e("span",[a._v("共"+a._s(a.pagination.total)+"条记录")])])]),a._v(" "),a.showAddDialog?e("add-valve",{on:{close:function(t){a.showAddDialog=!1},refresh:a.getAlarmConfigList}}):a._e(),a._v(" "),a.showSettingDialog?e("setting-valve",{attrs:{showSettingRow:a.showSettingRow},on:{closeSettingDialog:a.closeSettingDialog}}):a._e()],1)},staticRenderFns:[]};var p=e("VU/8")(c,m,!1,function(a){e("gZ0j")},"data-v-03ab5828",null);t.default=p.exports},gZ0j:function(a,t){}});