webpackJsonp([22],{"2XKC":function(e,t){},"466d":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s("mtWM");var a=s("P9l9"),i={props:{editRow:{type:Object,default:function(){}}},mounted:function(){this.getParentsData(),this.getRoleList(),this.getSysGroupIdList(),console.log(this.editRow)},data:function(){return{developGroupOptions:[],roleOptions:[],editUserForm:{username:null,roleIds:null,email:null,mobile:null,sysGroupId:null,oaAccount:null},pagination:{page:1,total:30,size:10}}},methods:{getParentsData:function(){if(this.editRow)if(this.editRow.roleIds&&"string"==typeof this.editRow.roleIds&&0!=this.editRow.roleIds.length){var e=this.editRow.roleIds;this.editRow.roleIds=e.split(",");for(var t=0;t<this.editRow.roleIds.length;t++)this.editRow.roleIds[t]=Number(this.editRow.roleIds[t]);0==this.editRow.sysGroupId&&(this.editRow.sysGroupId=null),this.editUserForm=this.editRow,console.log(this.editUserForm)}else this.editUserForm=this.editRow,console.log(this.editUserForm)},getSysGroupIdList:function(){var e=this;this.$post(a.a.systemManager.developSelectList,null,function(t){e.developGroupOptions=t.list})},submitEdit:function(){var e=this,t={};if(e.editUserForm){if(t.userId=e.editUserForm.userId,t.username=e.editUserForm.username,t.password=e.editUserForm.password,e.editUserForm.sysGroupId&&""!=e.editUserForm.sysGroupId?t.sysGroupId=e.editUserForm.sysGroupId:t.sysGroupId=0,t.email=e.editUserForm.email,t.mobile=e.editUserForm.mobile,t.oaAccount=e.editUserForm.oaAccount,t.roleIdList=e.editUserForm.roleIds,!t.username)return void e.$message.warning("用户名不能为空!");if(!t.oaAccount)return void e.$message.warning("OA账号不能为空！");if(t.roleIdList&&0==t.roleIdList.length)return void e.$message.warning("角色不能为空！");if(!t.email)return void e.$message.warning("邮箱不能为空！");if(!t.password)return void e.$message.warning("密码不能为空！");if(!t.mobile)return void e.$message.warning("电话号码不能为空！");if(t.mobile){if(11!=t.mobile.length)return void e.$message.warning("请输入有效的11位号码！");if(!/^1[3456789]\d{9}$/.test(t.mobile))return void e.$message.warning("手机号码有误，请重填")}if(""!==t.email){if(!/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(t.email))return void e.$message.warning("请输入有效的邮箱!")}e.$post(a.a.systemManager.userUpdata,t,function(t){0===t.code?(e.$message.success("编辑用户成功！"),e.editUserForm={username:null,roleIds:null,email:null,mobile:null,sysGroupId:null,oaAccount:null},e.$emit("closeEdit"),e.$emit("refresh")):e.$message.error(t.msg)})}},getRoleList:function(){var e=this;this.$post(a.a.systemManager.roleListAll,null,function(t){0===t.code?e.roleOptions=t.data:e.$message.error(t.msg)})},closeEdit:function(){this.$emit("closeEdit")}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{staticClass:"editUserDialog",attrs:{visible:!0,width:"650px","close-on-press-escape":!1,"show-close":!1,"close-on-click-modal":!1,"append-to-body":""}},[s("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[s("span",[e._v("编辑用户")]),e._v(" "),s("span",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},attrs:{title:"关闭"},on:{click:e.closeEdit}})]),e._v(" "),s("div",{staticClass:"editUserDialog_form"},[s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("用户名称")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.editUserForm.username,expression:"editUserForm.username"}],staticClass:"form_input",attrs:{type:"text",placeholder:"请输入"},domProps:{value:e.editUserForm.username},on:{input:function(t){t.target.composing||e.$set(e.editUserForm,"username",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("OA账号")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.editUserForm.oaAccount,expression:"editUserForm.oaAccount"}],staticClass:"form_input",attrs:{type:"text",placeholder:"请输入"},domProps:{value:e.editUserForm.oaAccount},on:{input:function(t){t.target.composing||e.$set(e.editUserForm,"oaAccount",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("角色")])]),e._v(" "),s("el-select",{attrs:{multiple:""},model:{value:e.editUserForm.roleIds,callback:function(t){e.$set(e.editUserForm,"roleIds",t)},expression:"editUserForm.roleIds"}},e._l(e.roleOptions,function(e,t){return s("el-option",{key:t,attrs:{label:e.roleName,value:e.roleId}})}),1)],1),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("邮箱")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.editUserForm.email,expression:"editUserForm.email"}],staticClass:"form_input",attrs:{type:"email",placeholder:"请输入"},domProps:{value:e.editUserForm.email},on:{input:function(t){t.target.composing||e.$set(e.editUserForm,"email",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("电话号码")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.editUserForm.mobile,expression:"editUserForm.mobile"}],staticClass:"form_input",attrs:{type:"text",placeholder:"请输入",oninput:"value=value.replace(/[^\\d]/g,'')",minlength:"11",maxlength:"11"},domProps:{value:e.editUserForm.mobile},on:{input:function(t){t.target.composing||e.$set(e.editUserForm,"mobile",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"}),s("span",{staticClass:"form_item_label"},[e._v("研发组")])]),e._v(" "),s("el-select",{attrs:{clearable:""},model:{value:e.editUserForm.sysGroupId,callback:function(t){e.$set(e.editUserForm,"sysGroupId",t)},expression:"editUserForm.sysGroupId"}},e._l(e.developGroupOptions,function(e,t){return s("el-option",{key:t,attrs:{label:e.groupName,value:e.groupId}})}),1)],1)]),e._v(" "),s("span",{staticClass:"editUserDialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"editDialogButton",staticStyle:{"margin-right":"30px"},attrs:{title:"取消"},on:{click:e.closeEdit}},[e._v("取 消")]),e._v(" "),s("button",{staticClass:"editDialogButton",attrs:{type:"primary",title:"确定"},on:{click:e.submitEdit}},[e._v("确 定")])])])},staticRenderFns:[]};var r={components:{EditDialog:s("VU/8")(i,o,!1,function(e){s("boP6")},null,null).exports},mounted:function(){this.getUser()},data:function(){return{editRow:{},editDialogShow:!1,developGroupOptions:[],roleOptions:[],userNameKey:null,usertableData:[],pagination:{page:1,total:30,size:10},newUserDialog:!1,addUserForm:{username:null,roleIdList:null,email:null,mobile:null,sysGroupId:[],oaAccount:null}}},methods:{syGroupChange:function(e){this.addUserForm.sysGroupId=e},getSysGroupIdList:function(){var e=this;this.$post(a.a.systemManager.developSelectList,null,function(t){e.developGroupOptions=t.list})},roleChange:function(e){console.log(e)},getRoleList:function(){var e=this;this.$post(a.a.systemManager.roleListAll,null,function(t){0===t.code?e.roleOptions=t.data:e.$message.error(t.msg)})},searchUser:function(){this.pagination.page=1,this.getUser()},getUser:function(){var e=this,t={};t.page=e.pagination.page,t.limit=e.pagination.size,t.username=e.userNameKey,e.$post(a.a.systemManager.userList,t,function(t){console.log(t),0===t.code?(e.usertableData=t.page.list,e.pagination.total=Number(t.page.totalCount),console.log(e.usertableData)):e.$message.warning(t.msg)})},submitAdd:function(){var e=this,t={};if(e.addUserForm){if((t=e.addUserForm).password="admin",t.status=1,t.sysGroupId=t.sysGroupId?t.sysGroupId:0,!t.username)return void e.$message.warning("用户名不能为空!");if(!t.oaAccount)return void e.$message.warning("OA账号不能为空！");if(t.roleIdList&&0==t.roleIdList.length)return void e.$message.warning("角色不能为空！");if(!t.email)return void e.$message.warning("邮箱不能为空！");if(!t.password)return void e.$message.warning("密码不能为空！");if(!t.mobile)return void e.$message.warning("电话号码不能为空！");if(e.addUserForm.mobile){if(11!=e.addUserForm.mobile.length)return void e.$message.warning("请输入有效的11位号码！");if(!/^1[3456789]\d{9}$/.test(e.addUserForm.mobile))return void e.$message.warning("手机号码有误，请重填!")}if(""!==t.email){if(!/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(t.email))return void e.$message.warning("请输入有效的邮箱!")}e.$post(a.a.systemManager.newUserSave,t,function(t){0===t.code?(e.$message.success("新增用户成功！"),e.addUserForm={},e.newUserDialog=!1,e.getUser()):e.$message.error(t.msg)})}},closeEdit:function(){this.editDialogShow=!1},editHandle:function(e,t){this.editDialogShow=!0,this.editRow=t,console.log(this.editRow)},deleteHandle:function(e,t){var s=this;console.log(t);var i=[];i.push(t.userId),this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.$post(a.a.systemManager.userDelete,i,function(t){0===t.code?(s.usertableData.splice(e,1),s.$message.success("删除成功！"),s.getUser(),console.log(t)):s.$message.error(t.msg)})})},handleCurrentChange:function(e){this.pagination.page=e,this.getUser(),console.log("当前页: "+e)},closeAddUser:function(){this.newUserDialog=!1,this.addUserForm={}},addUserHandle:function(){this.newUserDialog=!0,this.getRoleList(),this.getSysGroupIdList()}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"systemsManage"},[s("div",{staticClass:"systemsManage_search"},[s("div",{staticClass:"systemsManage_search_left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userNameKey,expression:"userNameKey"}],staticClass:"searchInput",attrs:{placeholder:"用户名称"},domProps:{value:e.userNameKey},on:{input:function(t){t.target.composing||(e.userNameKey=t.target.value)}}}),e._v(" "),s("div",{staticClass:"search_icon",on:{click:e.searchUser}},[s("span",{staticClass:"el-icon-search",attrs:{title:"搜索"}})])]),e._v(" "),s("div",{staticClass:"addUser",on:{click:e.addUserHandle}},[e._v("\n      添加\n    ")])]),e._v(" "),s("el-table",{ref:"usertableData",staticClass:"systemsManage_table",staticStyle:{width:"100%"},attrs:{data:e.usertableData,border:""}},[s("el-table-column",{attrs:{prop:"username",label:"用户名称","min-width":"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"oaAccount",label:"OA账号","min-width":"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"roleNames",label:"角色","min-width":"140"}}),e._v(" "),s("el-table-column",{attrs:{prop:"email",label:"邮箱","min-width":"160"}}),e._v(" "),s("el-table-column",{attrs:{prop:"mobile",label:"电话号码","min-width":"140"}}),e._v(" "),s("el-table-column",{attrs:{prop:"sysGroupName",label:"研发组","min-width":"140"}}),e._v(" "),s("el-table-column",{attrs:{prop:"dat7",label:"操作","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("button",{staticClass:"tablebutton editBut",attrs:{title:"编辑"},on:{click:function(s){return e.editHandle(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),s("button",{staticClass:"tablebutton deleteBut",attrs:{title:"删除"},on:{click:function(s){return e.deleteHandle(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("div",{staticClass:"pagination"},[s("div",{staticClass:"pagination-left"},[s("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),s("div",{staticClass:"pagination-right"},[e._v("\n      当前显示"+e._s((e.pagination.page-1)*e.pagination.size+1)+"-"+e._s((e.pagination.page-1)*e.pagination.size+e.usertableData.length)+"条记录 "),s("span",[e._v("共"+e._s(e.pagination.total)+"条记录")])])]),e._v(" "),s("el-dialog",{staticClass:"addUserDialog",attrs:{visible:e.newUserDialog,width:"650px","close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1,"append-to-body":""},on:{"update:visible":function(t){e.newUserDialog=t}}},[s("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[s("span",[e._v("添加用户")]),e._v(" "),s("span",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer"},attrs:{title:"关闭"},on:{click:e.closeAddUser}})]),e._v(" "),s("div",{staticClass:"newUserDialog_form"},[s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("用户名称")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.addUserForm.username,expression:"addUserForm.username"}],staticClass:"form_input",attrs:{type:"text",placeholder:"请输入"},domProps:{value:e.addUserForm.username},on:{input:function(t){t.target.composing||e.$set(e.addUserForm,"username",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("OA账号")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.addUserForm.oaAccount,expression:"addUserForm.oaAccount"}],staticClass:"form_input",attrs:{type:"text",placeholder:"请输入"},domProps:{value:e.addUserForm.oaAccount},on:{input:function(t){t.target.composing||e.$set(e.addUserForm,"oaAccount",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("角色")])]),e._v(" "),s("el-select",{attrs:{multiple:"",filterable:""},on:{change:e.roleChange},model:{value:e.addUserForm.roleIdList,callback:function(t){e.$set(e.addUserForm,"roleIdList",t)},expression:"addUserForm.roleIdList"}},e._l(e.roleOptions,function(e,t){return s("el-option",{key:t,attrs:{label:e.roleName,value:e.roleId}})}),1)],1),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("邮箱")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.addUserForm.email,expression:"addUserForm.email"}],staticClass:"form_input",attrs:{type:"email",placeholder:"请输入"},domProps:{value:e.addUserForm.email},on:{input:function(t){t.target.composing||e.$set(e.addUserForm,"email",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"},[e._v("*")]),s("span",{staticClass:"form_item_label"},[e._v("电话号码")])]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.addUserForm.mobile,expression:"addUserForm.mobile"}],staticClass:"form_input",attrs:{type:"text",placeholder:"请输入",oninput:"value=value.replace(/[^\\d]/g,'')",maxlength:"11"},domProps:{value:e.addUserForm.mobile},on:{input:function(t){t.target.composing||e.$set(e.addUserForm,"mobile",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form_item"},[s("div",{staticClass:"form_item_left"},[s("span",{staticClass:"star"}),s("span",{staticClass:"form_item_label"},[e._v("研发组")])]),e._v(" "),s("el-select",{attrs:{clearable:"",filterable:""},on:{change:e.syGroupChange},model:{value:e.addUserForm.sysGroupId,callback:function(t){e.$set(e.addUserForm,"sysGroupId",t)},expression:"addUserForm.sysGroupId"}},e._l(e.developGroupOptions,function(e,t){return s("el-option",{key:t,attrs:{label:e.groupName,value:e.groupId}})}),1)],1)]),e._v(" "),s("span",{staticClass:"newUserDialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"newDialogButton",staticStyle:{"margin-right":"30px"},attrs:{title:"取消"},on:{click:e.closeAddUser}},[e._v("取 消")]),e._v(" "),s("button",{staticClass:"newDialogButton",attrs:{type:"primary",title:"确定"},on:{click:e.submitAdd}},[e._v("确 定")])])]),e._v(" "),e.editDialogShow?[s("EditDialog",{attrs:{editRow:e.editRow},on:{closeEdit:e.closeEdit,refresh:e.getUser}})]:e._e()],2)},staticRenderFns:[]};var n=s("VU/8")(r,l,!1,function(e){s("2XKC")},"data-v-364356b1",null);t.default=n.exports},boP6:function(e,t){}});